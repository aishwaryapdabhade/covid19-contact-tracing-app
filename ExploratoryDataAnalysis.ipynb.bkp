{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pyspark.sql import SparkSession\n",
    "from pyspark.sql.functions import *\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pydeck as pdk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('/home/aishw/shared_folder/API_KEYS/mapbox.txt') as fp:\n",
    "    mapbox_api_key=fp.read()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "spark = SparkSession.builder.appName(\"LocationDataProcessor\").getOrCreate()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = spark.read.parquet('/home/aishw/shared_folder/user-location-processing/data/tmp.parquet')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DataFrame[device_key: bigint, unix_time: bigint, min_duration_seconds: bigint, observation_count: int, latitude: double, longitude: double, zipcode_5: string, state_abbr: string, cluster_type2: string, datetime: timestamp, str_time: bigint, end_time: bigint, datetime_str_time: timestamp, datetime_end_time: timestamp, __index_level_0__: bigint]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>device_key</th>\n",
       "      <th>unix_time</th>\n",
       "      <th>min_duration_seconds</th>\n",
       "      <th>observation_count</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>zipcode_5</th>\n",
       "      <th>state_abbr</th>\n",
       "      <th>cluster_type2</th>\n",
       "      <th>datetime</th>\n",
       "      <th>str_time</th>\n",
       "      <th>end_time</th>\n",
       "      <th>datetime_str_time</th>\n",
       "      <th>datetime_end_time</th>\n",
       "      <th>__index_level_0__</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1188</td>\n",
       "      <td>1546378629</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.854000</td>\n",
       "      <td>-87.651000</td>\n",
       "      <td>60608</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 16:37:09</td>\n",
       "      <td>1546378629</td>\n",
       "      <td>1546378629</td>\n",
       "      <td>2019-01-01 16:37:09</td>\n",
       "      <td>2019-01-01 16:37:09</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2048</td>\n",
       "      <td>1546353483</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.840390</td>\n",
       "      <td>-87.783210</td>\n",
       "      <td>60402</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 09:38:03</td>\n",
       "      <td>1546353483</td>\n",
       "      <td>1546353483</td>\n",
       "      <td>2019-01-01 09:38:03</td>\n",
       "      <td>2019-01-01 09:38:03</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2048</td>\n",
       "      <td>1546538227</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.849730</td>\n",
       "      <td>-87.728900</td>\n",
       "      <td>60623</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 12:57:07</td>\n",
       "      <td>1546538227</td>\n",
       "      <td>1546538227</td>\n",
       "      <td>2019-01-03 12:57:07</td>\n",
       "      <td>2019-01-03 12:57:07</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549696</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.247950</td>\n",
       "      <td>-88.000360</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 16:08:16</td>\n",
       "      <td>1546549696</td>\n",
       "      <td>1546549696</td>\n",
       "      <td>2019-01-03 16:08:16</td>\n",
       "      <td>2019-01-03 16:08:16</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549697</td>\n",
       "      <td>61</td>\n",
       "      <td>3</td>\n",
       "      <td>42.247810</td>\n",
       "      <td>-88.000450</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>t1</td>\n",
       "      <td>2019-01-03 16:08:17</td>\n",
       "      <td>1546549697</td>\n",
       "      <td>1546549758</td>\n",
       "      <td>2019-01-03 16:08:17</td>\n",
       "      <td>2019-01-03 16:09:18</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549758</td>\n",
       "      <td>61</td>\n",
       "      <td>3</td>\n",
       "      <td>42.267170</td>\n",
       "      <td>-88.017750</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>t2</td>\n",
       "      <td>2019-01-03 16:09:18</td>\n",
       "      <td>1546549758</td>\n",
       "      <td>1546549819</td>\n",
       "      <td>2019-01-03 16:09:18</td>\n",
       "      <td>2019-01-03 16:10:19</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549823</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.267960</td>\n",
       "      <td>-88.011900</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 16:10:23</td>\n",
       "      <td>1546549823</td>\n",
       "      <td>1546549823</td>\n",
       "      <td>2019-01-03 16:10:23</td>\n",
       "      <td>2019-01-03 16:10:23</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549866</td>\n",
       "      <td>120</td>\n",
       "      <td>4</td>\n",
       "      <td>42.248370</td>\n",
       "      <td>-87.986640</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>t1</td>\n",
       "      <td>2019-01-03 16:11:06</td>\n",
       "      <td>1546549866</td>\n",
       "      <td>1546549986</td>\n",
       "      <td>2019-01-03 16:11:06</td>\n",
       "      <td>2019-01-03 16:13:06</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549904</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.256990</td>\n",
       "      <td>-88.016950</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 16:11:44</td>\n",
       "      <td>1546549904</td>\n",
       "      <td>1546549904</td>\n",
       "      <td>2019-01-03 16:11:44</td>\n",
       "      <td>2019-01-03 16:11:44</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2362</td>\n",
       "      <td>1546549986</td>\n",
       "      <td>120</td>\n",
       "      <td>4</td>\n",
       "      <td>42.275380</td>\n",
       "      <td>-88.014080</td>\n",
       "      <td>60060</td>\n",
       "      <td>IL</td>\n",
       "      <td>t2</td>\n",
       "      <td>2019-01-03 16:13:06</td>\n",
       "      <td>1546549986</td>\n",
       "      <td>1546550106</td>\n",
       "      <td>2019-01-03 16:13:06</td>\n",
       "      <td>2019-01-03 16:15:06</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546304204</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.527890</td>\n",
       "      <td>-88.164090</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2018-12-31 19:56:44</td>\n",
       "      <td>1546304204</td>\n",
       "      <td>1546304204</td>\n",
       "      <td>2018-12-31 19:56:44</td>\n",
       "      <td>2018-12-31 19:56:44</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546362095</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>41.527955</td>\n",
       "      <td>-88.164130</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 12:01:35</td>\n",
       "      <td>1546362095</td>\n",
       "      <td>1546362104</td>\n",
       "      <td>2019-01-01 12:01:35</td>\n",
       "      <td>2019-01-01 12:01:44</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546400555</td>\n",
       "      <td>16</td>\n",
       "      <td>2</td>\n",
       "      <td>41.527950</td>\n",
       "      <td>-88.164100</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 22:42:35</td>\n",
       "      <td>1546400555</td>\n",
       "      <td>1546400571</td>\n",
       "      <td>2019-01-01 22:42:35</td>\n",
       "      <td>2019-01-01 22:42:51</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546437521</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.527950</td>\n",
       "      <td>-88.164080</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-02 08:58:41</td>\n",
       "      <td>1546437521</td>\n",
       "      <td>1546437521</td>\n",
       "      <td>2019-01-02 08:58:41</td>\n",
       "      <td>2019-01-02 08:58:41</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546526532</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>41.528050</td>\n",
       "      <td>-88.164117</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 09:42:12</td>\n",
       "      <td>1546526532</td>\n",
       "      <td>1546526535</td>\n",
       "      <td>2019-01-03 09:42:12</td>\n",
       "      <td>2019-01-03 09:42:15</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>3889</td>\n",
       "      <td>1546551159</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.531770</td>\n",
       "      <td>-88.166010</td>\n",
       "      <td>60435</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 16:32:39</td>\n",
       "      <td>1546551159</td>\n",
       "      <td>1546551159</td>\n",
       "      <td>2019-01-03 16:32:39</td>\n",
       "      <td>2019-01-03 16:32:39</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546573938</td>\n",
       "      <td>811</td>\n",
       "      <td>1</td>\n",
       "      <td>41.944300</td>\n",
       "      <td>-87.811500</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-03 22:52:18</td>\n",
       "      <td>1546573938</td>\n",
       "      <td>1546574749</td>\n",
       "      <td>2019-01-03 22:52:18</td>\n",
       "      <td>2019-01-03 23:05:49</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546595965</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.944300</td>\n",
       "      <td>-87.811500</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 04:59:25</td>\n",
       "      <td>1546595965</td>\n",
       "      <td>1546595965</td>\n",
       "      <td>2019-01-04 04:59:25</td>\n",
       "      <td>2019-01-04 04:59:25</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546661417</td>\n",
       "      <td>1316</td>\n",
       "      <td>2</td>\n",
       "      <td>41.944300</td>\n",
       "      <td>-87.811500</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 23:10:17</td>\n",
       "      <td>1546661417</td>\n",
       "      <td>1546662733</td>\n",
       "      <td>2019-01-04 23:10:17</td>\n",
       "      <td>2019-01-04 23:32:13</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546686789</td>\n",
       "      <td>2040</td>\n",
       "      <td>3</td>\n",
       "      <td>41.944170</td>\n",
       "      <td>-87.811480</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 06:13:09</td>\n",
       "      <td>1546686789</td>\n",
       "      <td>1546688829</td>\n",
       "      <td>2019-01-05 06:13:09</td>\n",
       "      <td>2019-01-05 06:47:09</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546688057</td>\n",
       "      <td>391</td>\n",
       "      <td>3</td>\n",
       "      <td>41.945720</td>\n",
       "      <td>-87.806790</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>t1</td>\n",
       "      <td>2019-01-05 06:34:17</td>\n",
       "      <td>1546688057</td>\n",
       "      <td>1546688448</td>\n",
       "      <td>2019-01-05 06:34:17</td>\n",
       "      <td>2019-01-05 06:40:48</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546688270</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.944300</td>\n",
       "      <td>-87.811500</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 06:37:50</td>\n",
       "      <td>1546688270</td>\n",
       "      <td>1546688270</td>\n",
       "      <td>2019-01-05 06:37:50</td>\n",
       "      <td>2019-01-05 06:37:50</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546688342</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.951860</td>\n",
       "      <td>-87.809070</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 06:39:02</td>\n",
       "      <td>1546688342</td>\n",
       "      <td>1546688342</td>\n",
       "      <td>2019-01-05 06:39:02</td>\n",
       "      <td>2019-01-05 06:39:02</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546688448</td>\n",
       "      <td>391</td>\n",
       "      <td>3</td>\n",
       "      <td>41.946350</td>\n",
       "      <td>-87.769280</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>t2</td>\n",
       "      <td>2019-01-05 06:40:48</td>\n",
       "      <td>1546688448</td>\n",
       "      <td>1546688839</td>\n",
       "      <td>2019-01-05 06:40:48</td>\n",
       "      <td>2019-01-05 06:47:19</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546688625</td>\n",
       "      <td>135</td>\n",
       "      <td>1</td>\n",
       "      <td>41.944300</td>\n",
       "      <td>-87.811500</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 06:43:45</td>\n",
       "      <td>1546688625</td>\n",
       "      <td>1546688760</td>\n",
       "      <td>2019-01-05 06:43:45</td>\n",
       "      <td>2019-01-05 06:46:00</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>4348</td>\n",
       "      <td>1546689018</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.942130</td>\n",
       "      <td>-87.805320</td>\n",
       "      <td>60634</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 06:50:18</td>\n",
       "      <td>1546689018</td>\n",
       "      <td>1546689018</td>\n",
       "      <td>2019-01-05 06:50:18</td>\n",
       "      <td>2019-01-05 06:50:18</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>4738</td>\n",
       "      <td>1546400575</td>\n",
       "      <td>41</td>\n",
       "      <td>1</td>\n",
       "      <td>42.378370</td>\n",
       "      <td>-87.832710</td>\n",
       "      <td>60085</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 22:42:55</td>\n",
       "      <td>1546400575</td>\n",
       "      <td>1546400616</td>\n",
       "      <td>2019-01-01 22:42:55</td>\n",
       "      <td>2019-01-01 22:43:36</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>4738</td>\n",
       "      <td>1546619810</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.412880</td>\n",
       "      <td>-87.855470</td>\n",
       "      <td>60087</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 11:36:50</td>\n",
       "      <td>1546619810</td>\n",
       "      <td>1546619810</td>\n",
       "      <td>2019-01-04 11:36:50</td>\n",
       "      <td>2019-01-04 11:36:50</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>4738</td>\n",
       "      <td>1546628455</td>\n",
       "      <td>179</td>\n",
       "      <td>1</td>\n",
       "      <td>42.468460</td>\n",
       "      <td>-87.885730</td>\n",
       "      <td>60099</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 14:00:55</td>\n",
       "      <td>1546628455</td>\n",
       "      <td>1546628634</td>\n",
       "      <td>2019-01-04 14:00:55</td>\n",
       "      <td>2019-01-04 14:03:54</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>4960</td>\n",
       "      <td>1546354207</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>41.861890</td>\n",
       "      <td>-87.622000</td>\n",
       "      <td>60605</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 09:50:07</td>\n",
       "      <td>1546354207</td>\n",
       "      <td>1546354208</td>\n",
       "      <td>2019-01-01 09:50:07</td>\n",
       "      <td>2019-01-01 09:50:08</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>4960</td>\n",
       "      <td>1546438513</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>41.861910</td>\n",
       "      <td>-87.622080</td>\n",
       "      <td>60605</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-02 09:15:13</td>\n",
       "      <td>1546438513</td>\n",
       "      <td>1546438514</td>\n",
       "      <td>2019-01-02 09:15:13</td>\n",
       "      <td>2019-01-02 09:15:14</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>4960</td>\n",
       "      <td>1546587178</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.861870</td>\n",
       "      <td>-87.622120</td>\n",
       "      <td>60605</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 02:32:58</td>\n",
       "      <td>1546587178</td>\n",
       "      <td>1546587178</td>\n",
       "      <td>2019-01-04 02:32:58</td>\n",
       "      <td>2019-01-04 02:32:58</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>4960</td>\n",
       "      <td>1546640858</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.861890</td>\n",
       "      <td>-87.621930</td>\n",
       "      <td>60605</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 17:27:38</td>\n",
       "      <td>1546640858</td>\n",
       "      <td>1546640858</td>\n",
       "      <td>2019-01-04 17:27:38</td>\n",
       "      <td>2019-01-04 17:27:38</td>\n",
       "      <td>32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>5256</td>\n",
       "      <td>1546652900</td>\n",
       "      <td>1141</td>\n",
       "      <td>2</td>\n",
       "      <td>41.746205</td>\n",
       "      <td>-87.782620</td>\n",
       "      <td>60459</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-04 20:48:20</td>\n",
       "      <td>1546652900</td>\n",
       "      <td>1546654041</td>\n",
       "      <td>2019-01-04 20:48:20</td>\n",
       "      <td>2019-01-04 21:07:21</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546332430</td>\n",
       "      <td>231</td>\n",
       "      <td>3</td>\n",
       "      <td>42.190220</td>\n",
       "      <td>-88.003670</td>\n",
       "      <td>60069</td>\n",
       "      <td>IL</td>\n",
       "      <td>t1</td>\n",
       "      <td>2019-01-01 03:47:10</td>\n",
       "      <td>1546332430</td>\n",
       "      <td>1546332661</td>\n",
       "      <td>2019-01-01 03:47:10</td>\n",
       "      <td>2019-01-01 03:51:01</td>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546332661</td>\n",
       "      <td>231</td>\n",
       "      <td>3</td>\n",
       "      <td>42.190000</td>\n",
       "      <td>-88.076260</td>\n",
       "      <td>60069</td>\n",
       "      <td>IL</td>\n",
       "      <td>t2</td>\n",
       "      <td>2019-01-01 03:51:01</td>\n",
       "      <td>1546332661</td>\n",
       "      <td>1546332892</td>\n",
       "      <td>2019-01-01 03:51:01</td>\n",
       "      <td>2019-01-01 03:54:52</td>\n",
       "      <td>35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546332711</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.189930</td>\n",
       "      <td>-88.070100</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 03:51:51</td>\n",
       "      <td>1546332711</td>\n",
       "      <td>1546332711</td>\n",
       "      <td>2019-01-01 03:51:51</td>\n",
       "      <td>2019-01-01 03:51:51</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546333123</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.191580</td>\n",
       "      <td>-88.062410</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 03:58:43</td>\n",
       "      <td>1546333123</td>\n",
       "      <td>1546333123</td>\n",
       "      <td>2019-01-01 03:58:43</td>\n",
       "      <td>2019-01-01 03:58:43</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546333183</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.188580</td>\n",
       "      <td>-88.095120</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 03:59:43</td>\n",
       "      <td>1546333183</td>\n",
       "      <td>1546333183</td>\n",
       "      <td>2019-01-01 03:59:43</td>\n",
       "      <td>2019-01-01 03:59:43</td>\n",
       "      <td>38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546361258</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>42.199820</td>\n",
       "      <td>-88.083300</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 11:47:38</td>\n",
       "      <td>1546361258</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>2019-01-01 11:47:38</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.199820</td>\n",
       "      <td>-88.083300</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.199820</td>\n",
       "      <td>-88.083300</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.199820</td>\n",
       "      <td>-88.083300</td>\n",
       "      <td>60047</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>1546361268</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>2019-01-01 11:47:48</td>\n",
       "      <td>42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.075260</td>\n",
       "      <td>-88.294970</td>\n",
       "      <td>60118</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.075260</td>\n",
       "      <td>-88.294970</td>\n",
       "      <td>60118</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>6234</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>42.075260</td>\n",
       "      <td>-88.294970</td>\n",
       "      <td>60118</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>1546713331</td>\n",
       "      <td>1546713342</td>\n",
       "      <td>2019-01-05 13:35:31</td>\n",
       "      <td>2019-01-05 13:35:42</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>7055</td>\n",
       "      <td>1546729435</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>41.627760</td>\n",
       "      <td>-87.853550</td>\n",
       "      <td>60462</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-05 18:03:55</td>\n",
       "      <td>1546729435</td>\n",
       "      <td>1546729435</td>\n",
       "      <td>2019-01-05 18:03:55</td>\n",
       "      <td>2019-01-05 18:03:55</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>7520</td>\n",
       "      <td>1546362690</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>42.075200</td>\n",
       "      <td>-88.184020</td>\n",
       "      <td>60010</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 12:11:30</td>\n",
       "      <td>1546362690</td>\n",
       "      <td>1546362693</td>\n",
       "      <td>2019-01-01 12:11:30</td>\n",
       "      <td>2019-01-01 12:11:33</td>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>7520</td>\n",
       "      <td>1546362690</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>42.075200</td>\n",
       "      <td>-88.184020</td>\n",
       "      <td>60010</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 12:11:30</td>\n",
       "      <td>1546362690</td>\n",
       "      <td>1546362693</td>\n",
       "      <td>2019-01-01 12:11:30</td>\n",
       "      <td>2019-01-01 12:11:33</td>\n",
       "      <td>48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>7520</td>\n",
       "      <td>1546371310</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>42.149570</td>\n",
       "      <td>-88.019230</td>\n",
       "      <td>60074</td>\n",
       "      <td>IL</td>\n",
       "      <td>v</td>\n",
       "      <td>2019-01-01 14:35:10</td>\n",
       "      <td>1546371310</td>\n",
       "      <td>1546371310</td>\n",
       "      <td>2019-01-01 14:35:10</td>\n",
       "      <td>2019-01-01 14:35:10</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    device_key   unix_time  min_duration_seconds  observation_count  \\\n",
       "0         1188  1546378629                     0                  1   \n",
       "1         2048  1546353483                     0                  1   \n",
       "2         2048  1546538227                     0                  1   \n",
       "3         2362  1546549696                     0                  1   \n",
       "4         2362  1546549697                    61                  3   \n",
       "5         2362  1546549758                    61                  3   \n",
       "6         2362  1546549823                     0                  1   \n",
       "7         2362  1546549866                   120                  4   \n",
       "8         2362  1546549904                     0                  1   \n",
       "9         2362  1546549986                   120                  4   \n",
       "10        3889  1546304204                     0                  1   \n",
       "11        3889  1546362095                     9                  2   \n",
       "12        3889  1546400555                    16                  2   \n",
       "13        3889  1546437521                     0                  1   \n",
       "14        3889  1546526532                     3                  3   \n",
       "15        3889  1546551159                     0                  1   \n",
       "16        4348  1546573938                   811                  1   \n",
       "17        4348  1546595965                     0                  1   \n",
       "18        4348  1546661417                  1316                  2   \n",
       "19        4348  1546686789                  2040                  3   \n",
       "20        4348  1546688057                   391                  3   \n",
       "21        4348  1546688270                     0                  1   \n",
       "22        4348  1546688342                     0                  1   \n",
       "23        4348  1546688448                   391                  3   \n",
       "24        4348  1546688625                   135                  1   \n",
       "25        4348  1546689018                     0                  1   \n",
       "26        4738  1546400575                    41                  1   \n",
       "27        4738  1546619810                     0                  1   \n",
       "28        4738  1546628455                   179                  1   \n",
       "29        4960  1546354207                     1                  1   \n",
       "30        4960  1546438513                     1                  2   \n",
       "31        4960  1546587178                     0                  1   \n",
       "32        4960  1546640858                     0                  1   \n",
       "33        5256  1546652900                  1141                  2   \n",
       "34        6234  1546332430                   231                  3   \n",
       "35        6234  1546332661                   231                  3   \n",
       "36        6234  1546332711                     0                  1   \n",
       "37        6234  1546333123                     0                  1   \n",
       "38        6234  1546333183                     0                  1   \n",
       "39        6234  1546361258                    10                  1   \n",
       "40        6234  1546361268                     0                  1   \n",
       "41        6234  1546361268                     0                  1   \n",
       "42        6234  1546361268                     0                  1   \n",
       "43        6234  1546713331                     0                  1   \n",
       "44        6234  1546713331                     0                  1   \n",
       "45        6234  1546713331                    11                  1   \n",
       "46        7055  1546729435                     0                  1   \n",
       "47        7520  1546362690                     3                  1   \n",
       "48        7520  1546362690                     3                  1   \n",
       "49        7520  1546371310                     0                  1   \n",
       "\n",
       "     latitude  longitude zipcode_5 state_abbr cluster_type2  \\\n",
       "0   41.854000 -87.651000     60608         IL             v   \n",
       "1   41.840390 -87.783210     60402         IL             v   \n",
       "2   41.849730 -87.728900     60623         IL             v   \n",
       "3   42.247950 -88.000360     60060         IL             v   \n",
       "4   42.247810 -88.000450     60060         IL            t1   \n",
       "5   42.267170 -88.017750     60060         IL            t2   \n",
       "6   42.267960 -88.011900     60060         IL             v   \n",
       "7   42.248370 -87.986640     60060         IL            t1   \n",
       "8   42.256990 -88.016950     60060         IL             v   \n",
       "9   42.275380 -88.014080     60060         IL            t2   \n",
       "10  41.527890 -88.164090     60435         IL             v   \n",
       "11  41.527955 -88.164130     60435         IL             v   \n",
       "12  41.527950 -88.164100     60435         IL             v   \n",
       "13  41.527950 -88.164080     60435         IL             v   \n",
       "14  41.528050 -88.164117     60435         IL             v   \n",
       "15  41.531770 -88.166010     60435         IL             v   \n",
       "16  41.944300 -87.811500     60634         IL             v   \n",
       "17  41.944300 -87.811500     60634         IL             v   \n",
       "18  41.944300 -87.811500     60634         IL             v   \n",
       "19  41.944170 -87.811480     60634         IL             v   \n",
       "20  41.945720 -87.806790     60634         IL            t1   \n",
       "21  41.944300 -87.811500     60634         IL             v   \n",
       "22  41.951860 -87.809070     60634         IL             v   \n",
       "23  41.946350 -87.769280     60634         IL            t2   \n",
       "24  41.944300 -87.811500     60634         IL             v   \n",
       "25  41.942130 -87.805320     60634         IL             v   \n",
       "26  42.378370 -87.832710     60085         IL             v   \n",
       "27  42.412880 -87.855470     60087         IL             v   \n",
       "28  42.468460 -87.885730     60099         IL             v   \n",
       "29  41.861890 -87.622000     60605         IL             v   \n",
       "30  41.861910 -87.622080     60605         IL             v   \n",
       "31  41.861870 -87.622120     60605         IL             v   \n",
       "32  41.861890 -87.621930     60605         IL             v   \n",
       "33  41.746205 -87.782620     60459         IL             v   \n",
       "34  42.190220 -88.003670     60069         IL            t1   \n",
       "35  42.190000 -88.076260     60069         IL            t2   \n",
       "36  42.189930 -88.070100     60047         IL             v   \n",
       "37  42.191580 -88.062410     60047         IL             v   \n",
       "38  42.188580 -88.095120     60047         IL             v   \n",
       "39  42.199820 -88.083300     60047         IL             v   \n",
       "40  42.199820 -88.083300     60047         IL             v   \n",
       "41  42.199820 -88.083300     60047         IL             v   \n",
       "42  42.199820 -88.083300     60047         IL             v   \n",
       "43  42.075260 -88.294970     60118         IL             v   \n",
       "44  42.075260 -88.294970     60118         IL             v   \n",
       "45  42.075260 -88.294970     60118         IL             v   \n",
       "46  41.627760 -87.853550     60462         IL             v   \n",
       "47  42.075200 -88.184020     60010         IL             v   \n",
       "48  42.075200 -88.184020     60010         IL             v   \n",
       "49  42.149570 -88.019230     60074         IL             v   \n",
       "\n",
       "              datetime    str_time    end_time   datetime_str_time  \\\n",
       "0  2019-01-01 16:37:09  1546378629  1546378629 2019-01-01 16:37:09   \n",
       "1  2019-01-01 09:38:03  1546353483  1546353483 2019-01-01 09:38:03   \n",
       "2  2019-01-03 12:57:07  1546538227  1546538227 2019-01-03 12:57:07   \n",
       "3  2019-01-03 16:08:16  1546549696  1546549696 2019-01-03 16:08:16   \n",
       "4  2019-01-03 16:08:17  1546549697  1546549758 2019-01-03 16:08:17   \n",
       "5  2019-01-03 16:09:18  1546549758  1546549819 2019-01-03 16:09:18   \n",
       "6  2019-01-03 16:10:23  1546549823  1546549823 2019-01-03 16:10:23   \n",
       "7  2019-01-03 16:11:06  1546549866  1546549986 2019-01-03 16:11:06   \n",
       "8  2019-01-03 16:11:44  1546549904  1546549904 2019-01-03 16:11:44   \n",
       "9  2019-01-03 16:13:06  1546549986  1546550106 2019-01-03 16:13:06   \n",
       "10 2018-12-31 19:56:44  1546304204  1546304204 2018-12-31 19:56:44   \n",
       "11 2019-01-01 12:01:35  1546362095  1546362104 2019-01-01 12:01:35   \n",
       "12 2019-01-01 22:42:35  1546400555  1546400571 2019-01-01 22:42:35   \n",
       "13 2019-01-02 08:58:41  1546437521  1546437521 2019-01-02 08:58:41   \n",
       "14 2019-01-03 09:42:12  1546526532  1546526535 2019-01-03 09:42:12   \n",
       "15 2019-01-03 16:32:39  1546551159  1546551159 2019-01-03 16:32:39   \n",
       "16 2019-01-03 22:52:18  1546573938  1546574749 2019-01-03 22:52:18   \n",
       "17 2019-01-04 04:59:25  1546595965  1546595965 2019-01-04 04:59:25   \n",
       "18 2019-01-04 23:10:17  1546661417  1546662733 2019-01-04 23:10:17   \n",
       "19 2019-01-05 06:13:09  1546686789  1546688829 2019-01-05 06:13:09   \n",
       "20 2019-01-05 06:34:17  1546688057  1546688448 2019-01-05 06:34:17   \n",
       "21 2019-01-05 06:37:50  1546688270  1546688270 2019-01-05 06:37:50   \n",
       "22 2019-01-05 06:39:02  1546688342  1546688342 2019-01-05 06:39:02   \n",
       "23 2019-01-05 06:40:48  1546688448  1546688839 2019-01-05 06:40:48   \n",
       "24 2019-01-05 06:43:45  1546688625  1546688760 2019-01-05 06:43:45   \n",
       "25 2019-01-05 06:50:18  1546689018  1546689018 2019-01-05 06:50:18   \n",
       "26 2019-01-01 22:42:55  1546400575  1546400616 2019-01-01 22:42:55   \n",
       "27 2019-01-04 11:36:50  1546619810  1546619810 2019-01-04 11:36:50   \n",
       "28 2019-01-04 14:00:55  1546628455  1546628634 2019-01-04 14:00:55   \n",
       "29 2019-01-01 09:50:07  1546354207  1546354208 2019-01-01 09:50:07   \n",
       "30 2019-01-02 09:15:13  1546438513  1546438514 2019-01-02 09:15:13   \n",
       "31 2019-01-04 02:32:58  1546587178  1546587178 2019-01-04 02:32:58   \n",
       "32 2019-01-04 17:27:38  1546640858  1546640858 2019-01-04 17:27:38   \n",
       "33 2019-01-04 20:48:20  1546652900  1546654041 2019-01-04 20:48:20   \n",
       "34 2019-01-01 03:47:10  1546332430  1546332661 2019-01-01 03:47:10   \n",
       "35 2019-01-01 03:51:01  1546332661  1546332892 2019-01-01 03:51:01   \n",
       "36 2019-01-01 03:51:51  1546332711  1546332711 2019-01-01 03:51:51   \n",
       "37 2019-01-01 03:58:43  1546333123  1546333123 2019-01-01 03:58:43   \n",
       "38 2019-01-01 03:59:43  1546333183  1546333183 2019-01-01 03:59:43   \n",
       "39 2019-01-01 11:47:38  1546361258  1546361268 2019-01-01 11:47:38   \n",
       "40 2019-01-01 11:47:48  1546361268  1546361268 2019-01-01 11:47:48   \n",
       "41 2019-01-01 11:47:48  1546361268  1546361268 2019-01-01 11:47:48   \n",
       "42 2019-01-01 11:47:48  1546361268  1546361268 2019-01-01 11:47:48   \n",
       "43 2019-01-05 13:35:31  1546713331  1546713331 2019-01-05 13:35:31   \n",
       "44 2019-01-05 13:35:31  1546713331  1546713331 2019-01-05 13:35:31   \n",
       "45 2019-01-05 13:35:31  1546713331  1546713342 2019-01-05 13:35:31   \n",
       "46 2019-01-05 18:03:55  1546729435  1546729435 2019-01-05 18:03:55   \n",
       "47 2019-01-01 12:11:30  1546362690  1546362693 2019-01-01 12:11:30   \n",
       "48 2019-01-01 12:11:30  1546362690  1546362693 2019-01-01 12:11:30   \n",
       "49 2019-01-01 14:35:10  1546371310  1546371310 2019-01-01 14:35:10   \n",
       "\n",
       "     datetime_end_time  __index_level_0__  \n",
       "0  2019-01-01 16:37:09                  0  \n",
       "1  2019-01-01 09:38:03                  1  \n",
       "2  2019-01-03 12:57:07                  2  \n",
       "3  2019-01-03 16:08:16                  3  \n",
       "4  2019-01-03 16:09:18                  4  \n",
       "5  2019-01-03 16:10:19                  5  \n",
       "6  2019-01-03 16:10:23                  6  \n",
       "7  2019-01-03 16:13:06                  7  \n",
       "8  2019-01-03 16:11:44                  8  \n",
       "9  2019-01-03 16:15:06                  9  \n",
       "10 2018-12-31 19:56:44                 10  \n",
       "11 2019-01-01 12:01:44                 11  \n",
       "12 2019-01-01 22:42:51                 12  \n",
       "13 2019-01-02 08:58:41                 13  \n",
       "14 2019-01-03 09:42:15                 14  \n",
       "15 2019-01-03 16:32:39                 15  \n",
       "16 2019-01-03 23:05:49                 16  \n",
       "17 2019-01-04 04:59:25                 17  \n",
       "18 2019-01-04 23:32:13                 18  \n",
       "19 2019-01-05 06:47:09                 19  \n",
       "20 2019-01-05 06:40:48                 20  \n",
       "21 2019-01-05 06:37:50                 21  \n",
       "22 2019-01-05 06:39:02                 22  \n",
       "23 2019-01-05 06:47:19                 23  \n",
       "24 2019-01-05 06:46:00                 24  \n",
       "25 2019-01-05 06:50:18                 25  \n",
       "26 2019-01-01 22:43:36                 26  \n",
       "27 2019-01-04 11:36:50                 27  \n",
       "28 2019-01-04 14:03:54                 28  \n",
       "29 2019-01-01 09:50:08                 29  \n",
       "30 2019-01-02 09:15:14                 30  \n",
       "31 2019-01-04 02:32:58                 31  \n",
       "32 2019-01-04 17:27:38                 32  \n",
       "33 2019-01-04 21:07:21                 33  \n",
       "34 2019-01-01 03:51:01                 34  \n",
       "35 2019-01-01 03:54:52                 35  \n",
       "36 2019-01-01 03:51:51                 36  \n",
       "37 2019-01-01 03:58:43                 37  \n",
       "38 2019-01-01 03:59:43                 38  \n",
       "39 2019-01-01 11:47:48                 39  \n",
       "40 2019-01-01 11:47:48                 40  \n",
       "41 2019-01-01 11:47:48                 41  \n",
       "42 2019-01-01 11:47:48                 42  \n",
       "43 2019-01-05 13:35:31                 43  \n",
       "44 2019-01-05 13:35:31                 44  \n",
       "45 2019-01-05 13:35:42                 45  \n",
       "46 2019-01-05 18:03:55                 46  \n",
       "47 2019-01-01 12:11:33                 47  \n",
       "48 2019-01-01 12:11:33                 48  \n",
       "49 2019-01-01 14:35:10                 49  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.limit(50).toPandas()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1000000"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "new_df = df.select(['device_key','min_duration_seconds','latitude','longitude'])\n",
    "df.createOrReplaceTempView(\"location_df\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "from shapely.geometry import Point, Polygon\n",
    "import fiona"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'properties': OrderedDict([('STATEFP', 'str:2'), ('COUNTYFP', 'str:3'), ('COUNTYNS', 'str:8'), ('GEOID', 'str:5'), ('NAME', 'str:100'), ('NAMELSAD', 'str:100'), ('LSAD', 'str:2'), ('CLASSFP', 'str:2'), ('MTFCC', 'str:5'), ('CSAFP', 'str:3'), ('CBSAFP', 'str:5'), ('METDIVFP', 'str:5'), ('FUNCSTAT', 'str:1'), ('ALAND', 'int:14'), ('AWATER', 'int:14'), ('INTPTLAT', 'str:11'), ('INTPTLON', 'str:12')]), 'geometry': 'Polygon'}\n",
      "Cuming County\n",
      "Wahkiakum County\n",
      "De Baca County\n",
      "Lancaster County\n",
      "Nuckolls County\n",
      "Las Piedras Municipio\n",
      "Minnehaha County\n",
      "Menard County\n",
      "Sierra County\n",
      "Clinton County\n",
      "Hancock County\n",
      "Hale County\n",
      "Clay County\n",
      "Armstrong County\n",
      "Allen County\n",
      "McDuffie County\n",
      "Sauk County\n",
      "Stone County\n",
      "Wallowa County\n",
      "Beaver County\n",
      "Jasper County\n",
      "Henry County\n",
      "Saguache County\n",
      "Chatham County\n",
      "Rich County\n",
      "Adair County\n",
      "Lake County\n",
      "Salem city\n",
      "Montgomery County\n",
      "Hamilton County\n",
      "Otero County\n",
      "Catron County\n",
      "Marengo County\n",
      "Lincoln County\n",
      "Barton County\n",
      "Calhoun County\n",
      "Poquoson city\n",
      "Pocahontas County\n",
      "Clay County\n",
      "James City County\n",
      "Keith County\n",
      "Phelps County\n",
      "Calcasieu Parish\n",
      "Union Parish\n",
      "Sequoyah County\n",
      "DeKalb County\n",
      "Steuben County\n",
      "Forest County\n",
      "Tangipahoa Parish\n",
      "Stafford County\n",
      "Menominee County\n",
      "Jasper County\n",
      "Brantley County\n",
      "Lamar County\n",
      "Steuben County\n",
      "Orange County\n",
      "Fayette County\n",
      "Hampshire County\n",
      "Allen County\n",
      "Alamance County\n",
      "Greenwood County\n",
      "Suffolk County\n",
      "Jefferson County\n",
      "Gonzales County\n",
      "Marion County\n",
      "Alpena County\n",
      "Wayne County\n",
      "White County\n",
      "Fannin County\n",
      "Doniphan County\n",
      "Kerr County\n",
      "Hernando County\n",
      "Wakulla County\n",
      "Walton County\n",
      "Chickasaw County\n",
      "Ketchikan Gateway Borough\n",
      "Clare County\n",
      "Republic County\n",
      "Volusia County\n",
      "Canadian County\n",
      "Quebradillas Municipio\n",
      "St. Thomas Island\n",
      "Floyd County\n",
      "Churchill County\n",
      "Webster County\n",
      "Hancock County\n",
      "Hutchinson County\n",
      "Crook County\n",
      "Franklin County\n",
      "Marquette County\n",
      "Middlesex County\n",
      "Davidson County\n",
      "Clay County\n",
      "Knox County\n",
      "Livingston County\n",
      "Tioga County\n",
      "Dakota County\n",
      "Leelanau County\n",
      "Surry County\n",
      "Refugio County\n",
      "Butler County\n",
      "Terrell County\n",
      "Clayton County\n",
      "Fremont County\n",
      "Ohio County\n",
      "Columbia County\n",
      "Sedgwick County\n",
      "Musselshell County\n",
      "Dauphin County\n",
      "Moody County\n",
      "Putnam County\n",
      "Sussex County\n",
      "Decatur County\n",
      "Perry County\n",
      "Union County\n",
      "Boyd County\n",
      "Mille Lacs County\n",
      "Walsh County\n",
      "Morgan County\n",
      "Portage County\n",
      "Uinta County\n",
      "Humboldt County\n",
      "Jim Hogg County\n",
      "Cheyenne County\n",
      "Clackamas County\n",
      "Polk County\n",
      "Macon County\n",
      "Benton County\n",
      "Morgan County\n",
      "Douglas County\n",
      "Worcester County\n",
      "Wabash County\n",
      "Huntington County\n",
      "Scott County\n",
      "Decatur County\n",
      "Wabash County\n",
      "Allen County\n",
      "Marshall County\n",
      "Thomas County\n",
      "Sioux County\n",
      "Dimmit County\n",
      "Fillmore County\n",
      "Chester County\n",
      "Lac qui Parle County\n",
      "Cache County\n",
      "Pierce County\n",
      "Charlton County\n",
      "Polk County\n",
      "McLean County\n",
      "Androscoggin County\n",
      "Kootenai County\n",
      "Clark County\n",
      "Phillips County\n",
      "Holt County\n",
      "Johnson County\n",
      "La Crosse County\n",
      "Caldwell Parish\n",
      "Edmonson County\n",
      "Bond County\n",
      "Brown County\n",
      "McLeod County\n",
      "Dunn County\n",
      "Custer County\n",
      "Madison County\n",
      "Nolan County\n",
      "Wayne County\n",
      "Saratoga County\n",
      "Brazos County\n",
      "Marshall County\n",
      "Allegany County\n",
      "Wetzel County\n",
      "Jackson County\n",
      "Clatsop County\n",
      "Lewis County\n",
      "Allegany County\n",
      "Cedar County\n",
      "Orange County\n",
      "DeKalb County\n",
      "Pickens County\n",
      "Chouteau County\n",
      "Brown County\n",
      "Campbell County\n",
      "Franklin County\n",
      "Baltimore city\n",
      "Lyon County\n",
      "Carroll County\n",
      "Tensas Parish\n",
      "Monroe County\n",
      "Hamilton County\n",
      "Pocahontas County\n",
      "Gem County\n",
      "Independence County\n",
      "Lonoke County\n",
      "Newton County\n",
      "Franklin County\n",
      "Hendry County\n",
      "Taliaferro County\n",
      "Jefferson County\n",
      "Meagher County\n",
      "La Plata County\n",
      "Bell County\n",
      "Kemper County\n",
      "Clark County\n",
      "Klamath County\n",
      "Oswego County\n",
      "Naranjito Municipio\n",
      "Cherokee County\n",
      "Bandera County\n",
      "Rosebud County\n",
      "Union County\n",
      "Schoolcraft County\n",
      "Ulster County\n",
      "Camden County\n",
      "Jersey County\n",
      "Hanover County\n",
      "Wallace County\n",
      "Alger County\n",
      "Fulton County\n",
      "Hidalgo County\n",
      "Robeson County\n",
      "Newaygo County\n",
      "Morrow County\n",
      "Todd County\n",
      "Logan County\n",
      "Lincoln County\n",
      "Miller County\n",
      "Orange County\n",
      "San Juan County\n",
      "Franklin County\n",
      "Carroll County\n",
      "Riley County\n",
      "Schleicher County\n",
      "Russell County\n",
      "Caldwell County\n",
      "Madison County\n",
      "Warrick County\n",
      "Adair County\n",
      "Gallatin County\n",
      "Harrison County\n",
      "Sagadahoc County\n",
      "Sweet Grass County\n",
      "Grayson County\n",
      "Greene County\n",
      "Northwest Arctic Borough\n",
      "Ellis County\n",
      "Hale County\n",
      "Perry County\n",
      "Colbert County\n",
      "Pratt County\n",
      "Bourbon County\n",
      "Rutherford County\n",
      "Cook County\n",
      "Lane County\n",
      "Harper County\n",
      "Piatt County\n",
      "Crosby County\n",
      "Fajardo Municipio\n",
      "Greene County\n",
      "Clark County\n",
      "Kossuth County\n",
      "Yabucoa Municipio\n",
      "Burke County\n",
      "Durham County\n",
      "Harrison County\n",
      "Keya Paha County\n",
      "Webster County\n",
      "Pope County\n",
      "Smith County\n",
      "Henry County\n",
      "Alexandria city\n",
      "Jefferson County\n",
      "Lewis and Clark County\n",
      "Duchesne County\n",
      "Alfalfa County\n",
      "Delta County\n",
      "Trousdale County\n",
      "Perry County\n",
      "Deuel County\n",
      "Jackson County\n",
      "Hormigueros Municipio\n",
      "Zavala County\n",
      "Banner County\n",
      "Madison County\n",
      "Broward County\n",
      "Toombs County\n",
      "Sanilac County\n",
      "Rockwall County\n",
      "Wayne County\n",
      "Nobles County\n",
      "Aitkin County\n",
      "Ramsey County\n",
      "Person County\n",
      "Trego County\n",
      "Washington County\n",
      "Eastland County\n",
      "Issaquena County\n",
      "DeWitt County\n",
      "Angelina County\n",
      "Saluda County\n",
      "Maries County\n",
      "Arkansas County\n",
      "Lawrence County\n",
      "Charlottesville city\n",
      "Bureau County\n",
      "Scioto County\n",
      "Madison County\n",
      "Jerome County\n",
      "Vinton County\n",
      "McLennan County\n",
      "Custer County\n",
      "Howard County\n",
      "Palm Beach County\n",
      "Lincoln County\n",
      "Butler County\n",
      "Sumner County\n",
      "King and Queen County\n",
      "Carroll County\n",
      "Waynesboro city\n",
      "Sitka City and Borough\n",
      "Multnomah County\n",
      "Grundy County\n",
      "Hubbard County\n",
      "Sargent County\n",
      "St. Lawrence County\n",
      "Reynolds County\n",
      "Sacramento County\n",
      "Paulding County\n",
      "Wells County\n",
      "Floyd County\n",
      "Santa Barbara County\n",
      "Boone County\n",
      "Benton County\n",
      "Crittenden County\n",
      "Palo Alto County\n",
      "Ringgold County\n",
      "Randolph County\n",
      "Cecil County\n",
      "Warren County\n",
      "Greeley County\n",
      "Jefferson County\n",
      "Saline County\n",
      "Knott County\n",
      "Clinton County\n",
      "Jackson County\n",
      "Dodge County\n",
      "Freeborn County\n",
      "Calaveras County\n",
      "Barnstable County\n",
      "Middlesex County\n",
      "Jefferson County\n",
      "Lake County\n",
      "Bedford County\n",
      "Clay County\n",
      "Coles County\n",
      "Lauderdale County\n",
      "Baker County\n",
      "Schuyler County\n",
      "Van Buren County\n",
      "Mercer County\n",
      "Lawrence County\n",
      "Morgan County\n",
      "Muhlenberg County\n",
      "Effingham County\n",
      "Loudon County\n",
      "Clark County\n",
      "Honolulu County\n",
      "Gilchrist County\n",
      "Tippecanoe County\n",
      "Snyder County\n",
      "Lamar County\n",
      "Miami-Dade County\n",
      "Dundy County\n",
      "Leon County\n",
      "Pitkin County\n",
      "Grand Forks County\n",
      "LaPorte County\n",
      "Hamilton County\n",
      "Emporia city\n",
      "Lincoln County\n",
      "Greeley County\n",
      "Harris County\n",
      "Screven County\n",
      "San Juan Municipio\n",
      "Stonewall County\n",
      "Henry County\n",
      "Grafton County\n",
      "Newton County\n",
      "Posey County\n",
      "McMullen County\n",
      "Cumberland County\n",
      "Walton County\n",
      "Pope County\n",
      "Rappahannock County\n",
      "Amherst County\n",
      "Ventura County\n",
      "Crawford County\n",
      "Park County\n",
      "Los Angeles County\n",
      "Yuma County\n",
      "Gordon County\n",
      "Calhoun County\n",
      "Highlands County\n",
      "Covington city\n",
      "Orange County\n",
      "McPherson County\n",
      "Pinal County\n",
      "Fulton County\n",
      "Alamosa County\n",
      "Citrus County\n",
      "Culebra Municipio\n",
      "Dorado Municipio\n",
      "DeKalb County\n",
      "Clarion County\n",
      "Miner County\n",
      "Jerauld County\n",
      "Decatur County\n",
      "Dubois County\n",
      "Essex County\n",
      "Williamsburg County\n",
      "Essex County\n",
      "Worth County\n",
      "Hughes County\n",
      "Buchanan County\n",
      "Alleghany County\n",
      "Lowndes County\n",
      "Scott County\n",
      "Prowers County\n",
      "Sutton County\n",
      "Sabana Grande Municipio\n",
      "Muskogee County\n",
      "Christian County\n",
      "Ciales Municipio\n",
      "Lamar County\n",
      "Ripley County\n",
      "Mercer County\n",
      "Hart County\n",
      "Jackson Parish\n",
      "Northumberland County\n",
      "Fort Bend County\n",
      "Green Lake County\n",
      "Pondera County\n",
      "Walworth County\n",
      "Mineral County\n",
      "Fulton County\n",
      "Suffolk County\n",
      "Union County\n",
      "McDonald County\n",
      "Scotts Bluff County\n",
      "San Miguel County\n",
      "Lee County\n",
      "Parker County\n",
      "Dickey County\n",
      "Barnes County\n",
      "Sibley County\n",
      "Upson County\n",
      "Sonoma County\n",
      "Chippewa County\n",
      "Bonneville County\n",
      "Barrow County\n",
      "Long County\n",
      "Kinney County\n",
      "Ottawa County\n",
      "Clearfield County\n",
      "Clinton County\n",
      "Santa Isabel Municipio\n",
      "Montgomery County\n",
      "Alcorn County\n",
      "Lafayette County\n",
      "Grant Parish\n",
      "Atchison County\n",
      "Macon County\n",
      "St. Joseph County\n",
      "Franklin County\n",
      "Garfield County\n",
      "Adams County\n",
      "Olmsted County\n",
      "Union County\n",
      "Trujillo Alto Municipio\n",
      "Mobile County\n",
      "McCook County\n",
      "Fayette County\n",
      "Chambers County\n",
      "Northampton County\n",
      "Moffat County\n",
      "Green County\n",
      "Franklin County\n",
      "Beaufort County\n",
      "Jayuya Municipio\n",
      "Burleigh County\n",
      "Rowan County\n",
      "Iron County\n",
      "Kandiyohi County\n",
      "Wolfe County\n",
      "Fayette County\n",
      "Lawrence County\n",
      "Washington County\n",
      "Briscoe County\n",
      "Ontonagon County\n",
      "Carroll County\n",
      "Benton County\n",
      "Rock County\n",
      "Indiana County\n",
      "Lincoln Parish\n",
      "Perry County\n",
      "Ziebach County\n",
      "Harrison County\n",
      "Baraga County\n",
      "Rogers County\n",
      "Boone County\n",
      "Mayagüez Municipio\n",
      "Caddo County\n",
      "Jefferson County\n",
      "Cabell County\n",
      "Reagan County\n",
      "Van Buren County\n",
      "Summit County\n",
      "Cowley County\n",
      "Johnson County\n",
      "Hamilton County\n",
      "Craig County\n",
      "Coleman County\n",
      "Yukon-Koyukuk Census Area\n",
      "Navajo County\n",
      "Lincoln County\n",
      "Ochiltree County\n",
      "Crane County\n",
      "Big Horn County\n",
      "Hickman County\n",
      "Tunica County\n",
      "Harrison County\n",
      "Canóvanas Municipio\n",
      "Bartholomew County\n",
      "Paulding County\n",
      "Brown County\n",
      "Putnam County\n",
      "Ward County\n",
      "Worcester County\n",
      "Logan County\n",
      "Kings County\n",
      "San Diego County\n",
      "Salinas Municipio\n",
      "Crawford County\n",
      "Naguabo Municipio\n",
      "Cass County\n",
      "Dutchess County\n",
      "Washington County\n",
      "Pueblo County\n",
      "Douglas County\n",
      "Bottineau County\n",
      "Cumberland County\n",
      "Hot Springs County\n",
      "Alcona County\n",
      "Placer County\n",
      "Searcy County\n",
      "Lynn County\n",
      "Otsego County\n",
      "Richmond County\n",
      "Hoke County\n",
      "Otoe County\n",
      "Cameron County\n",
      "Dorchester County\n",
      "Waseca County\n",
      "Brule County\n",
      "Warren County\n",
      "Clark County\n",
      "Robertson County\n",
      "Lake County\n",
      "Berkeley County\n",
      "Garland County\n",
      "Osage County\n",
      "Trumbull County\n",
      "Mills County\n",
      "Oldham County\n",
      "Butler County\n",
      "Idaho County\n",
      "Marion County\n",
      "Buckingham County\n",
      "Cabarrus County\n",
      "Webster County\n",
      "Davis County\n",
      "Cottonwood County\n",
      "Okeechobee County\n",
      "Union County\n",
      "Black Hawk County\n",
      "Sabine County\n",
      "Pike County\n",
      "Tuscaloosa County\n",
      "Wilcox County\n",
      "Montgomery County\n",
      "Kearney County\n",
      "Hitchcock County\n",
      "New Castle County\n",
      "Teton County\n",
      "Rock Island County\n",
      "Gloucester County\n",
      "Sevier County\n",
      "Cass County\n",
      "Power County\n",
      "Carroll County\n",
      "Philadelphia County\n",
      "Washakie County\n",
      "Camden County\n",
      "Tompkins County\n",
      "Jefferson County\n",
      "Lincoln County\n",
      "Vernon County\n",
      "Iron County\n",
      "Hopkins County\n",
      "Albany County\n",
      "Houston County\n",
      "Monroe County\n",
      "Rush County\n",
      "Montgomery County\n",
      "Stanton County\n",
      "Lee County\n",
      "Koochiching County\n",
      "Bexar County\n",
      "Boulder County\n",
      "Jefferson County\n",
      "Mayes County\n",
      "Watonwan County\n",
      "Blaine County\n",
      "Jefferson Davis Parish\n",
      "Sully County\n",
      "Denver County\n",
      "Coal County\n",
      "Carter County\n",
      "Upton County\n",
      "Gibson County\n",
      "Kimball County\n",
      "Kendall County\n",
      "District of Columbia\n",
      "Montrose County\n",
      "Wright County\n",
      "Kenosha County\n",
      "Eagle County\n",
      "San Francisco County\n",
      "San Miguel County\n",
      "Anchorage Municipality\n",
      "St. Johns County\n",
      "Choctaw County\n",
      "Grundy County\n",
      "Lake County\n",
      "Ottawa County\n",
      "Cook County\n",
      "Gallatin County\n",
      "Greenwood County\n",
      "Franklin County\n",
      "Clay County\n",
      "Haywood County\n",
      "Box Elder County\n",
      "Tippah County\n",
      "Marshall County\n",
      "Jackson County\n",
      "Elmore County\n",
      "Baltimore County\n",
      "Benson County\n",
      "Pike County\n",
      "Lawrence County\n",
      "Scott County\n",
      "Adams County\n",
      "Erath County\n",
      "Habersham County\n",
      "Wilkinson County\n",
      "Monongalia County\n",
      "Crawford County\n",
      "DeSoto County\n",
      "New London County\n",
      "Guernsey County\n",
      "Barry County\n",
      "Stone County\n",
      "Richmond city\n",
      "Stokes County\n",
      "Clarke County\n",
      "Fayette County\n",
      "Marin County\n",
      "Randall County\n",
      "Rusk County\n",
      "Warren County\n",
      "Van Wert County\n",
      "Glades County\n",
      "Meriwether County\n",
      "Costilla County\n",
      "Coryell County\n",
      "Adair County\n",
      "Chattahoochee County\n",
      "Mariposa County\n",
      "Howard County\n",
      "Marion County\n",
      "Milwaukee County\n",
      "Scott County\n",
      "Pickaway County\n",
      "Powhatan County\n",
      "Broomfield County\n",
      "Lawrence County\n",
      "Antrim County\n",
      "Marlboro County\n",
      "Benewah County\n",
      "Lee County\n",
      "Nemaha County\n",
      "Carteret County\n",
      "Pottawatomie County\n",
      "Jackson County\n",
      "Comal County\n",
      "Nantucket County\n",
      "Bamberg County\n",
      "Aransas County\n",
      "Berrien County\n",
      "Vermillion County\n",
      "Roscommon County\n",
      "Alleghany County\n",
      "Lassen County\n",
      "Falls Church city\n",
      "Manatee County\n",
      "Muskingum County\n",
      "Chaffee County\n",
      "Crowley County\n",
      "Fremont County\n",
      "Pearl River County\n",
      "Perry County\n",
      "Custer County\n",
      "Calhoun County\n",
      "Kenton County\n",
      "Chickasaw County\n",
      "DeKalb County\n",
      "Hancock County\n",
      "Stark County\n",
      "Luce County\n",
      "Carter County\n",
      "Pasquotank County\n",
      "Taos County\n",
      "Bolivar County\n",
      "Nye County\n",
      "Hawkins County\n",
      "Bowman County\n",
      "Fulton County\n",
      "Lafayette Parish\n",
      "Jack County\n",
      "Stark County\n",
      "Greer County\n",
      "Hemphill County\n",
      "Nez Perce County\n",
      "Walworth County\n",
      "Napa County\n",
      "Cotton County\n",
      "Washington County\n",
      "Cayuga County\n",
      "Shackelford County\n",
      "San Jacinto County\n",
      "Dubuque County\n",
      "Goochland County\n",
      "Sherman County\n",
      "Richland County\n",
      "Adams County\n",
      "Champaign County\n",
      "Sullivan County\n",
      "Iroquois County\n",
      "Poweshiek County\n",
      "Wayne County\n",
      "Fayette County\n",
      "Hancock County\n",
      "Kendall County\n",
      "Greene County\n",
      "Orange County\n",
      "McCurtain County\n",
      "Tift County\n",
      "Cass County\n",
      "Kingsbury County\n",
      "Converse County\n",
      "Herkimer County\n",
      "Logan County\n",
      "Gogebic County\n",
      "Becker County\n",
      "Marshall County\n",
      "Union County\n",
      "Mineral County\n",
      "Ashland County\n",
      "Ford County\n",
      "Emmons County\n",
      "Shasta County\n",
      "Vermilion Parish\n",
      "Randolph County\n",
      "Oneida County\n",
      "East Carroll Parish\n",
      "East Feliciana Parish\n",
      "St. Bernard Parish\n",
      "Wharton County\n",
      "Prince of Wales-Hyder Census Area\n",
      "Petersburg Borough\n",
      "Floyd County\n",
      "Wrangell City and Borough\n",
      "Madison County\n",
      "Blount County\n",
      "Gallatin County\n",
      "Darlington County\n",
      "Escambia County\n",
      "Haralson County\n",
      "Allen County\n",
      "Douglas County\n",
      "Greene County\n",
      "Guam\n",
      "Waushara County\n",
      "Izard County\n",
      "Monterey County\n",
      "Grant County\n",
      "Miller County\n",
      "Wilkes County\n",
      "Juneau City and Borough\n",
      "Platte County\n",
      "Buchanan County\n",
      "Limestone County\n",
      "Henry County\n",
      "Polk County\n",
      "Ottawa County\n",
      "Norman County\n",
      "Shelby County\n",
      "Carroll County\n",
      "Benton County\n",
      "Martin County\n",
      "Chisago County\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Owsley County\n",
      "Bradford County\n",
      "Hancock County\n",
      "Cole County\n",
      "Berrien County\n",
      "Huntingdon County\n",
      "Dawes County\n",
      "Patrick County\n",
      "Montmorency County\n",
      "Oscoda County\n",
      "Colfax County\n",
      "St. Clair County\n",
      "Washington County\n",
      "Bedford County\n",
      "Scott County\n",
      "Labette County\n",
      "Lawrence County\n",
      "Harrison County\n",
      "Alexander County\n",
      "Cape May County\n",
      "Cheshire County\n",
      "Marshall County\n",
      "King William County\n",
      "Huerfano County\n",
      "Karnes County\n",
      "Chester County\n",
      "Scott County\n",
      "Millard County\n",
      "Morgan County\n",
      "Kaufman County\n",
      "Greenlee County\n",
      "Maricopa County\n",
      "Ogemaw County\n",
      "Jackson County\n",
      "Richland County\n",
      "Blount County\n",
      "Liberty County\n",
      "Duval County\n",
      "Ralls County\n",
      "Johnson County\n",
      "Clay County\n",
      "Grant County\n",
      "Coos County\n",
      "Franklin County\n",
      "Warren County\n",
      "Madison County\n",
      "Atoka County\n",
      "Menard County\n",
      "Bartow County\n",
      "Lake County\n",
      "Okmulgee County\n",
      "Sheridan County\n",
      "Fulton County\n",
      "Johnson County\n",
      "Calvert County\n",
      "Washburn County\n",
      "Jefferson County\n",
      "Aguada Municipio\n",
      "Winona County\n",
      "Warren County\n",
      "Andrew County\n",
      "Montgomery County\n",
      "Cherokee County\n",
      "Halifax County\n",
      "Sandoval County\n",
      "Clay County\n",
      "Clinton County\n",
      "Linn County\n",
      "Lafayette County\n",
      "Washington County\n",
      "Preston County\n",
      "Rota Municipality\n",
      "Waupaca County\n",
      "Edwards County\n",
      "Lake County\n",
      "Ozark County\n",
      "Waller County\n",
      "Monroe County\n",
      "Essex County\n",
      "Lunenburg County\n",
      "Traill County\n",
      "Hall County\n",
      "Treutlen County\n",
      "Calhoun County\n",
      "Vilas County\n",
      "Beltrami County\n",
      "Coamo Municipio\n",
      "Guánica Municipio\n",
      "Dorchester County\n",
      "Columbia County\n",
      "Clark County\n",
      "Maverick County\n",
      "Pima County\n",
      "Cibola County\n",
      "Burlington County\n",
      "Rutland County\n",
      "Early County\n",
      "Dukes County\n",
      "McHenry County\n",
      "Wayne County\n",
      "LaMoure County\n",
      "Butte County\n",
      "Coos County\n",
      "Kidder County\n",
      "Kleberg County\n",
      "Porter County\n",
      "Newton County\n",
      "Sampson County\n",
      "Moore County\n",
      "Pinellas County\n",
      "Barranquitas Municipio\n",
      "Hamilton County\n",
      "Perry County\n",
      "Cheyenne County\n",
      "Delta County\n",
      "Wayne County\n",
      "Gaines County\n",
      "Marion County\n",
      "Watauga County\n",
      "Roanoke city\n",
      "Martin County\n",
      "Bowie County\n",
      "Weber County\n",
      "Marion County\n",
      "Jefferson County\n",
      "Jackson County\n",
      "Nelson County\n",
      "Clinton County\n",
      "Garfield County\n",
      "Ray County\n",
      "Hocking County\n",
      "Lowndes County\n",
      "Candler County\n",
      "Linn County\n",
      "Trinity County\n",
      "Muscogee County\n",
      "Tallahatchie County\n",
      "Atchison County\n",
      "Lares Municipio\n",
      "Andrews County\n",
      "Miami County\n",
      "Potter County\n",
      "Seminole County\n",
      "Aiken County\n",
      "Manu'a District\n",
      "Mendocino County\n",
      "Chesapeake city\n",
      "Tinian Municipality\n",
      "Yauco Municipio\n",
      "Sweetwater County\n",
      "Garza County\n",
      "Hardy County\n",
      "Adjuntas Municipio\n",
      "Ozaukee County\n",
      "Sullivan County\n",
      "Laurens County\n",
      "Crook County\n",
      "Sheboygan County\n",
      "Hampden County\n",
      "Caldwell County\n",
      "Cloud County\n",
      "Inyo County\n",
      "Coosa County\n",
      "Dickinson County\n",
      "Harlan County\n",
      "Geary County\n",
      "Berks County\n",
      "Carter County\n",
      "Lyon County\n",
      "Charlotte County\n",
      "Washington County\n",
      "Newberry County\n",
      "Isle of Wight County\n",
      "Wheeler County\n",
      "Butler County\n",
      "Iberville Parish\n",
      "Sharkey County\n",
      "Fauquier County\n",
      "Radford city\n",
      "Douglas County\n",
      "Franklin County\n",
      "Greene County\n",
      "Rush County\n",
      "Washington County\n",
      "Laclede County\n",
      "Mercer County\n",
      "Craighead County\n",
      "Saline County\n",
      "White County\n",
      "De Witt County\n",
      "White Pine County\n",
      "Goodhue County\n",
      "Swain County\n",
      "Pasco County\n",
      "Sumter County\n",
      "Nassau County\n",
      "Steele County\n",
      "Vanderburgh County\n",
      "Franklin County\n",
      "Avery County\n",
      "Wood County\n",
      "Bayfield County\n",
      "Stewart County\n",
      "Portage County\n",
      "Lexington County\n",
      "Anne Arundel County\n",
      "Fond du Lac County\n",
      "Webster County\n",
      "Kewaunee County\n",
      "Parmer County\n",
      "Woods County\n",
      "Elliott County\n",
      "Berkshire County\n",
      "Chariton County\n",
      "Rio Blanco County\n",
      "Morgan County\n",
      "Malheur County\n",
      "Middlesex County\n",
      "Russell County\n",
      "Putnam County\n",
      "Haakon County\n",
      "Macon County\n",
      "Cleburne County\n",
      "Pike County\n",
      "Adams County\n",
      "Bristol County\n",
      "Schuylkill County\n",
      "Wells County\n",
      "Cleveland County\n",
      "Hot Spring County\n",
      "Frederick County\n",
      "Schuyler County\n",
      "Mono County\n",
      "Tuolumne County\n",
      "Doña Ana County\n",
      "Crisp County\n",
      "Columbia County\n",
      "Griggs County\n",
      "Solano County\n",
      "Clayton County\n",
      "Titus County\n",
      "Hampshire County\n",
      "Moore County\n",
      "Barton County\n",
      "Slope County\n",
      "Richland Parish\n",
      "Garfield County\n",
      "St. Martin Parish\n",
      "Sumter County\n",
      "Winston County\n",
      "Seminole County\n",
      "Forrest County\n",
      "Ingham County\n",
      "Shawnee County\n",
      "Hanson County\n",
      "Itasca County\n",
      "Lincoln County\n",
      "Madison County\n",
      "Washington County\n",
      "Johnson County\n",
      "Terry County\n",
      "Harding County\n",
      "Talladega County\n",
      "Langlade County\n",
      "Foard County\n",
      "Buena Vista County\n",
      "Mills County\n",
      "Real County\n",
      "Delaware County\n",
      "Forsyth County\n",
      "Carson City\n",
      "Dallas County\n",
      "Carson County\n",
      "Sumter County\n",
      "Wayne County\n",
      "Anderson County\n",
      "Carbon County\n",
      "Silver Bow County\n",
      "Stephenson County\n",
      "Lapeer County\n",
      "Claiborne Parish\n",
      "Yalobusha County\n",
      "Maricao Municipio\n",
      "Kalkaska County\n",
      "Aguadilla Municipio\n",
      "Evangeline Parish\n",
      "Hardeman County\n",
      "Cochise County\n",
      "Hidalgo County\n",
      "Divide County\n",
      "San Bernardino County\n",
      "Montezuma County\n",
      "Clarke County\n",
      "Marion County\n",
      "Douglas County\n",
      "Fairfax city\n",
      "Harmon County\n",
      "Cedar County\n",
      "Clarke County\n",
      "Valley County\n",
      "Knox County\n",
      "Ouachita County\n",
      "Darke County\n",
      "Kay County\n",
      "Dewey County\n",
      "Tillamook County\n",
      "Coweta County\n",
      "Simpson County\n",
      "Stone County\n",
      "Contra Costa County\n",
      "Carroll County\n",
      "Henrico County\n",
      "Owen County\n",
      "Westchester County\n",
      "Bollinger County\n",
      "McDowell County\n",
      "Harrison County\n",
      "Granville County\n",
      "New Haven County\n",
      "Pierce County\n",
      "Bleckley County\n",
      "Burke County\n",
      "Union County\n",
      "Kankakee County\n",
      "McIntosh County\n",
      "Platte County\n",
      "Warren County\n",
      "Aibonito Municipio\n",
      "Marion County\n",
      "Clay County\n",
      "Sussex County\n",
      "Jasper County\n",
      "Randolph County\n",
      "Butler County\n",
      "Hays County\n",
      "Medina County\n",
      "Mason County\n",
      "Beaufort County\n",
      "Yankton County\n",
      "Rock County\n",
      "Pickens County\n",
      "Columbia County\n",
      "Clinton County\n",
      "Clinton County\n",
      "Minidoka County\n",
      "Sullivan County\n",
      "Rankin County\n",
      "Motley County\n",
      "Lane County\n",
      "Wichita County\n",
      "Shiawassee County\n",
      "Jewell County\n",
      "Mitchell County\n",
      "Bradford County\n",
      "Marion County\n",
      "George County\n",
      "Jo Daviess County\n",
      "Hancock County\n",
      "Franklin city\n",
      "Midland County\n",
      "Scott County\n",
      "Cascade County\n",
      "Harrisonburg city\n",
      "Williamson County\n",
      "Flathead County\n",
      "Peñuelas Municipio\n",
      "Stevens County\n",
      "Fayette County\n",
      "Hancock County\n",
      "Brown County\n",
      "Barbour County\n",
      "Wayne County\n",
      "Box Butte County\n",
      "Northumberland County\n",
      "Victoria County\n",
      "Buena Vista city\n",
      "St. Clair County\n",
      "Thurston County\n",
      "Lamoille County\n",
      "Franklin County\n",
      "Blaine County\n",
      "Kittitas County\n",
      "Randolph County\n",
      "Kane County\n",
      "Tucker County\n",
      "Ponce Municipio\n",
      "Crawford County\n",
      "Jackson County\n",
      "Mahaska County\n",
      "Douglas County\n",
      "Daviess County\n",
      "Powell County\n",
      "Jasper County\n",
      "Union County\n",
      "Henry County\n",
      "Adams County\n",
      "Pamlico County\n",
      "Graves County\n",
      "Cambria County\n",
      "McMinn County\n",
      "Livingston County\n",
      "Adams County\n",
      "Lackawanna County\n",
      "Pontotoc County\n",
      "Creek County\n",
      "Tyler County\n",
      "Van Buren County\n",
      "Pottawatomie County\n",
      "Tolland County\n",
      "Socorro County\n",
      "Atkinson County\n",
      "Duval County\n",
      "Falls County\n",
      "Yell County\n",
      "Comanche County\n",
      "Jessamine County\n",
      "Monroe County\n",
      "Kiowa County\n",
      "Lake County\n",
      "Caswell County\n",
      "Presidio County\n",
      "Greene County\n",
      "Willacy County\n",
      "Bayamón Municipio\n",
      "Los Alamos County\n",
      "Kenai Peninsula Borough\n",
      "Baldwin County\n",
      "Appanoose County\n",
      "St. Croix Island\n",
      "New Kent County\n",
      "Talbot County\n",
      "Lewis County\n",
      "Clay County\n",
      "Jefferson County\n",
      "Bedford County\n",
      "Mora County\n",
      "Boone County\n",
      "Oregon County\n",
      "Houston County\n",
      "Wyoming County\n",
      "Lenoir County\n",
      "Vigo County\n",
      "Elkhart County\n",
      "Grayson County\n",
      "Lubbock County\n",
      "Meeker County\n",
      "Ashland County\n",
      "Madison County\n",
      "Martin County\n",
      "Mineral County\n",
      "Dawson County\n",
      "Johnson County\n",
      "Monroe County\n",
      "Dallas County\n",
      "Pittsylvania County\n",
      "Denali Borough\n",
      "Pawnee County\n",
      "Wyandotte County\n",
      "Dixie County\n",
      "Tuscola County\n",
      "Southeast Fairbanks Census Area\n",
      "Graham County\n",
      "St. Landry Parish\n",
      "Giles County\n",
      "Lucas County\n",
      "Mississippi County\n",
      "Rincón Municipio\n",
      "Floyd County\n",
      "Morton County\n",
      "Grant County\n",
      "Taylor County\n",
      "Graham County\n",
      "Logan County\n",
      "Pleasants County\n",
      "Giles County\n",
      "Fayette County\n",
      "Snohomish County\n",
      "Eddy County\n",
      "McPherson County\n",
      "Red Willow County\n",
      "Rock County\n",
      "Humphreys County\n",
      "Mason County\n",
      "Wythe County\n",
      "Washington County\n",
      "Yakima County\n",
      "Washington County\n",
      "Henderson County\n",
      "Eau Claire County\n",
      "Sequatchie County\n",
      "Walker County\n",
      "Coconino County\n",
      "Sumner County\n",
      "Oceana County\n",
      "Kanabec County\n",
      "Ashtabula County\n",
      "Alpine County\n",
      "Galveston County\n",
      "Bullock County\n",
      "Livingston County\n",
      "Preble County\n",
      "Jackson County\n",
      "Harris County\n",
      "Middlesex County\n",
      "Vega Baja Municipio\n",
      "Dawson County\n",
      "Ontario County\n",
      "Valdez-Cordova Census Area\n",
      "Autauga County\n",
      "Miami County\n",
      "Dodge County\n",
      "Cortland County\n",
      "Camden County\n",
      "Washtenaw County\n",
      "LaGrange County\n",
      "Pecos County\n",
      "Peach County\n",
      "White County\n",
      "Jefferson County\n",
      "Oconto County\n",
      "Nacogdoches County\n",
      "Washington County\n",
      "Okanogan County\n",
      "Spokane County\n",
      "Forest County\n",
      "Sawyer County\n",
      "Hudson County\n",
      "Stark County\n",
      "Guadalupe County\n",
      "Island County\n",
      "Jefferson County\n",
      "Prince William County\n",
      "Chester County\n",
      "Mercer County\n",
      "Roane County\n",
      "Clallam County\n",
      "Stevens County\n",
      "Van Buren County\n",
      "Gosper County\n",
      "Monroe County\n",
      "Escambia County\n",
      "Tarrant County\n",
      "Prince George's County\n",
      "Scott County\n",
      "Jackson County\n",
      "Love County\n",
      "Twiggs County\n",
      "Mahoning County\n",
      "Macon County\n",
      "Wayne County\n",
      "Swisher County\n",
      "Osage County\n",
      "Kane County\n",
      "El Dorado County\n",
      "Kershaw County\n",
      "Gates County\n",
      "Otero County\n",
      "Douglas County\n",
      "Monroe County\n",
      "Newton County\n",
      "Cavalier County\n",
      "Noble County\n",
      "Gove County\n",
      "Pointe Coupee Parish\n",
      "Gage County\n",
      "St. Clair County\n",
      "Scott County\n",
      "Dougherty County\n",
      "Harrison County\n",
      "Bonner County\n",
      "Catoosa County\n",
      "LaSalle Parish\n",
      "Waldo County\n",
      "Howard County\n",
      "Salt Lake County\n",
      "Hartford County\n",
      "Windham County\n",
      "Monroe County\n",
      "Tuscarawas County\n",
      "Richmond County\n",
      "Highland County\n",
      "Lake of the Woods County\n",
      "Bingham County\n",
      "Cabo Rojo Municipio\n",
      "Humacao Municipio\n",
      "Juncos Municipio\n",
      "Greenville County\n",
      "Lyman County\n",
      "Trempealeau County\n",
      "Yolo County\n",
      "Sterling County\n",
      "Winkler County\n",
      "Jackson County\n",
      "Sevier County\n",
      "Charles City County\n",
      "Choctaw County\n",
      "Knox County\n",
      "Dawson County\n",
      "Ford County\n",
      "Williams County\n",
      "Cass County\n",
      "Hardin County\n",
      "Arthur County\n",
      "Frio County\n",
      "Johnson County\n",
      "Neosho County\n",
      "Greenup County\n",
      "Linn County\n",
      "Garfield County\n",
      "Eureka County\n",
      "Hayes County\n",
      "Phillips County\n",
      "Calhoun County\n",
      "Fairbanks North Star Borough\n",
      "Henderson County\n",
      "Holmes County\n",
      "Oktibbeha County\n",
      "Ceiba Municipio\n",
      "Corozal Municipio\n",
      "Fergus County\n",
      "Garrett County\n",
      "Webster Parish\n",
      "Hillsdale County\n",
      "Logan County\n",
      "Custer County\n",
      "Merrimack County\n",
      "York County\n",
      "Rutherford County\n",
      "Beadle County\n",
      "Cullman County\n",
      "Douglas County\n",
      "Johnson County\n",
      "Washington County\n",
      "Jones County\n",
      "Anson County\n",
      "Haines Borough\n",
      "Billings County\n",
      "Antelope County\n",
      "Gasconade County\n",
      "Butler County\n",
      "St. John Island\n",
      "Campbell County\n",
      "Morgan County\n",
      "Cross County\n",
      "Phillips County\n",
      "St. James Parish\n",
      "Yuba County\n",
      "Shelby County\n",
      "Ouray County\n",
      "Curry County\n",
      "Washita County\n",
      "Orange County\n",
      "Pulaski County\n",
      "Benzie County\n",
      "Erie County\n",
      "Montgomery County\n",
      "Manassas Park city\n",
      "Arlington County\n",
      "Carroll County\n",
      "St. Charles County\n",
      "San Benito County\n",
      "Queen Anne's County\n",
      "Brown County\n",
      "Bulloch County\n",
      "Floyd County\n",
      "Broadwater County\n",
      "Wheeler County\n",
      "Craven County\n",
      "Holt County\n",
      "Lipscomb County\n",
      "Columbia County\n",
      "Florence County\n",
      "Mountrail County\n",
      "Washington County\n",
      "Big Horn County\n",
      "Elk County\n",
      "Sioux County\n",
      "Covington County\n",
      "Moca Municipio\n",
      "Brown County\n",
      "Clark County\n",
      "Boyle County\n",
      "Estill County\n",
      "Collingsworth County\n",
      "Colorado County\n",
      "Grundy County\n",
      "Lincoln County\n",
      "Evans County\n",
      "Wise County\n",
      "Bethel Census Area\n",
      "Webster County\n",
      "Jones County\n",
      "Gwinnett County\n",
      "Polk County\n",
      "Green County\n",
      "Orocovis Municipio\n",
      "Putnam County\n",
      "Newport News city\n",
      "Bent County\n",
      "Jackson County\n",
      "Sanders County\n",
      "Glasscock County\n",
      "Franklin County\n",
      "Major County\n",
      "Montgomery County\n",
      "Pend Oreille County\n",
      "McLean County\n",
      "Hood River County\n",
      "Wright County\n",
      "Shelby County\n",
      "Crawford County\n",
      "Bath County\n",
      "Otter Tail County\n",
      "Plaquemines Parish\n",
      "Pontotoc County\n",
      "Morehouse Parish\n",
      "Bullitt County\n",
      "Dallas County\n",
      "Comanche County\n",
      "Lincoln County\n",
      "San Lorenzo Municipio\n",
      "Toa Alta Municipio\n",
      "Cass County\n",
      "Archuleta County\n",
      "Yazoo County\n",
      "Outagamie County\n",
      "Lafayette County\n",
      "Wilson County\n",
      "Morrow County\n",
      "Granite County\n",
      "Foster County\n",
      "Crawford County\n",
      "Burnet County\n",
      "Ste. Genevieve County\n",
      "Gray County\n",
      "McDonough County\n",
      "Montgomery County\n",
      "Jackson County\n",
      "Hudspeth County\n",
      "Rapides Parish\n",
      "Lincoln County\n",
      "Cass County\n",
      "Henry County\n",
      "Winchester city\n",
      "Duplin County\n",
      "Haywood County\n",
      "Dakota County\n",
      "Harney County\n",
      "Maunabo Municipio\n",
      "Adams County\n",
      "Clark County\n",
      "Boone County\n",
      "Washington County\n",
      "Avoyelles Parish\n",
      "Tate County\n",
      "Worth County\n",
      "Sherman County\n",
      "Campbell County\n",
      "Harding County\n",
      "Gratiot County\n",
      "Union County\n",
      "Massac County\n",
      "Logan County\n",
      "Merrick County\n",
      "Sheridan County\n",
      "Carlisle County\n",
      "Natrona County\n",
      "Worth County\n",
      "Morgan County\n",
      "Ellis County\n",
      "Pierce County\n",
      "Eastern District\n",
      "Grant County\n",
      "Flagler County\n",
      "Lawrence County\n",
      "Winn Parish\n",
      "Henry County\n",
      "Lincoln County\n",
      "York County\n",
      "Codington County\n",
      "Pike County\n",
      "Stewart County\n",
      "Monmouth County\n",
      "Clay County\n",
      "Faulkner County\n",
      "Delaware County\n",
      "Keokuk County\n",
      "Greene County\n",
      "Lake County\n",
      "Troup County\n",
      "Humboldt County\n",
      "Dickson County\n",
      "Anoka County\n",
      "Bon Homme County\n",
      "Greene County\n",
      "Sussex County\n",
      "St. Joseph County\n",
      "Pembina County\n",
      "Bennett County\n",
      "Vernon Parish\n",
      "Penobscot County\n",
      "Talbot County\n",
      "Stephens County\n",
      "Riverside County\n",
      "Baxter County\n",
      "Attala County\n",
      "Story County\n",
      "Bourbon County\n",
      "Cumberland County\n",
      "Sumter County\n",
      "Lake and Peninsula Borough\n",
      "Wyoming County\n",
      "Kern County\n",
      "Cooke County\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Orangeburg County\n",
      "Taylor County\n",
      "Mower County\n",
      "Murray County\n",
      "Providence County\n",
      "Phelps County\n",
      "Prentiss County\n",
      "Whitley County\n",
      "Starke County\n",
      "Williamson County\n",
      "Patillas Municipio\n",
      "Mitchell County\n",
      "Emanuel County\n",
      "Catahoula Parish\n",
      "Carbon County\n",
      "Pawnee County\n",
      "Unicoi County\n",
      "Spartanburg County\n",
      "Marathon County\n",
      "Elko County\n",
      "Braxton County\n",
      "Wexford County\n",
      "Cochran County\n",
      "Blair County\n",
      "Hickory County\n",
      "Barry County\n",
      "Ramsey County\n",
      "Little River County\n",
      "Lyon County\n",
      "Lee County\n",
      "Josephine County\n",
      "Manatí Municipio\n",
      "Pike County\n",
      "Coffee County\n",
      "Lemhi County\n",
      "Ohio County\n",
      "Sarpy County\n",
      "Colquitt County\n",
      "Wilkin County\n",
      "Randolph County\n",
      "Kennebec County\n",
      "Smyth County\n",
      "Roosevelt County\n",
      "Somerset County\n",
      "Washington County\n",
      "Guilford County\n",
      "Ada County\n",
      "Custer County\n",
      "Marion County\n",
      "Pike County\n",
      "Woodford County\n",
      "Richmond County\n",
      "Pickens County\n",
      "Ellis County\n",
      "Perry County\n",
      "Grundy County\n",
      "Routt County\n",
      "Somerset County\n",
      "Colusa County\n",
      "Johnson County\n",
      "Hinsdale County\n",
      "Cassia County\n",
      "Isanti County\n",
      "Erie County\n",
      "Copiah County\n",
      "Van Zandt County\n",
      "Roanoke County\n",
      "Augusta County\n",
      "Bristol Bay Borough\n",
      "Piute County\n",
      "Mason County\n",
      "Benton County\n",
      "Donley County\n",
      "Bay County\n",
      "Lauderdale County\n",
      "Fountain County\n",
      "Shelby County\n",
      "Fayette County\n",
      "Perry County\n",
      "Danville city\n",
      "Banks County\n",
      "Wayne County\n",
      "Oklahoma County\n",
      "Johnston County\n",
      "Jackson County\n",
      "Summit County\n",
      "Polk County\n",
      "Lander County\n",
      "Winneshiek County\n",
      "Bracken County\n",
      "Florence County\n",
      "Roane County\n",
      "Wadena County\n",
      "Hopewell city\n",
      "Winnebago County\n",
      "Gila County\n",
      "Wicomico County\n",
      "Carter County\n",
      "Iredell County\n",
      "Halifax County\n",
      "Hertford County\n",
      "Montgomery County\n",
      "Pennington County\n",
      "Whatcom County\n",
      "Gilliam County\n",
      "Ocean County\n",
      "Boone County\n",
      "Comanche County\n",
      "Jones County\n",
      "Grimes County\n",
      "Genesee County\n",
      "Assumption Parish\n",
      "Calhoun County\n",
      "Greene County\n",
      "Custer County\n",
      "Roberts County\n",
      "Ogle County\n",
      "Richland County\n",
      "Barron County\n",
      "Iron County\n",
      "Wabasha County\n",
      "Del Norte County\n",
      "Pushmataha County\n",
      "Chelan County\n",
      "Presque Isle County\n",
      "Cleveland County\n",
      "Sullivan County\n",
      "Polk County\n",
      "Scotland County\n",
      "Harnett County\n",
      "Lee County\n",
      "Tipton County\n",
      "Clay County\n",
      "Wagoner County\n",
      "Richland County\n",
      "Ashley County\n",
      "Desha County\n",
      "Vieques Municipio\n",
      "Perry County\n",
      "Washington County\n",
      "Portsmouth city\n",
      "Fayette County\n",
      "Grant County\n",
      "Shenandoah County\n",
      "Irion County\n",
      "Caldwell County\n",
      "Putnam County\n",
      "Crawford County\n",
      "Lewis County\n",
      "Grant County\n",
      "Loíza Municipio\n",
      "Oneida County\n",
      "Moultrie County\n",
      "Hopkins County\n",
      "Clearwater County\n",
      "Bell County\n",
      "Crow Wing County\n",
      "Western District\n",
      "Añasco Municipio\n",
      "Graham County\n",
      "St. Francis County\n",
      "Echols County\n",
      "Dillingham Census Area\n",
      "Lincoln County\n",
      "Smith County\n",
      "Jefferson County\n",
      "Cidra Municipio\n",
      "Amite County\n",
      "Montgomery County\n",
      "Calhoun County\n",
      "Cleburne County\n",
      "Weld County\n",
      "Beckham County\n",
      "Modoc County\n",
      "Polk County\n",
      "Liberty County\n",
      "Navarro County\n",
      "Brooks County\n",
      "Williamson County\n",
      "Laramie County\n",
      "Asotin County\n",
      "Traverse County\n",
      "Cass County\n",
      "Rockdale County\n",
      "Juniata County\n",
      "McKean County\n",
      "Garvin County\n",
      "Burt County\n",
      "San Juan County\n",
      "Orleans County\n",
      "De Soto Parish\n",
      "Fresno County\n",
      "Elbert County\n",
      "Barbour County\n",
      "Bladen County\n",
      "Dallam County\n",
      "Sangamon County\n",
      "Craig County\n",
      "Cumberland County\n",
      "Otsego County\n",
      "Sac County\n",
      "Emery County\n",
      "Ferry County\n",
      "Wibaux County\n",
      "Lincoln County\n",
      "Cherokee County\n",
      "Yellow Medicine County\n",
      "Hunt County\n",
      "Mitchell County\n",
      "Wood County\n",
      "Osage County\n",
      "Cherokee County\n",
      "Mecosta County\n",
      "Pike County\n",
      "Lafayette County\n",
      "Catawba County\n",
      "Breathitt County\n",
      "Childress County\n",
      "Ripley County\n",
      "Tazewell County\n",
      "Jeff Davis County\n",
      "Lexington city\n",
      "Sharp County\n",
      "Larimer County\n",
      "Tyrrell County\n",
      "Rice County\n",
      "Warren County\n",
      "Warren County\n",
      "Caddo Parish\n",
      "Todd County\n",
      "Marshall County\n",
      "Tillman County\n",
      "Macon County\n",
      "Monroe County\n",
      "Switzerland County\n",
      "Hickman County\n",
      "Geneva County\n",
      "LaSalle County\n",
      "Delaware County\n",
      "Morris County\n",
      "Davis County\n",
      "Boise County\n",
      "Monroe County\n",
      "Perquimans County\n",
      "Hamilton County\n",
      "Matanuska-Susitna Borough\n",
      "Delaware County\n",
      "Levy County\n",
      "Gurabo Municipio\n",
      "Hatillo Municipio\n",
      "Hancock County\n",
      "Wilcox County\n",
      "Red River Parish\n",
      "Knox County\n",
      "Oxford County\n",
      "Jackson County\n",
      "Towns County\n",
      "Smith County\n",
      "Payette County\n",
      "Shoshone County\n",
      "Hyde County\n",
      "Floyd County\n",
      "McCracken County\n",
      "Union County\n",
      "Turner County\n",
      "Cocke County\n",
      "Hancock County\n",
      "Hardin County\n",
      "Marion County\n",
      "Guayama Municipio\n",
      "Washington Parish\n",
      "Stoddard County\n",
      "Dooly County\n",
      "Stearns County\n",
      "Saunders County\n",
      "Sherburne County\n",
      "Davison County\n",
      "Claiborne County\n",
      "Montague County\n",
      "Brown County\n",
      "Racine County\n",
      "Shawano County\n",
      "Audubon County\n",
      "Haskell County\n",
      "Logan County\n",
      "Oneida County\n",
      "Lake County\n",
      "Pittsburg County\n",
      "Doddridge County\n",
      "Wirt County\n",
      "Carroll County\n",
      "Tyler County\n",
      "Northern Islands Municipality\n",
      "Le Sueur County\n",
      "Douglas County\n",
      "Cattaraugus County\n",
      "Dodge County\n",
      "Jones County\n",
      "Barber County\n",
      "Pulaski County\n",
      "Dale County\n",
      "Logan County\n",
      "Madera County\n",
      "Gentry County\n",
      "Blaine County\n",
      "Daggett County\n",
      "Platte County\n",
      "Gaston County\n",
      "Guadalupe County\n",
      "Golden Valley County\n",
      "Johnston County\n",
      "Santa Clara County\n",
      "Charleston County\n",
      "Benton County\n",
      "Adair County\n",
      "Erie County\n",
      "Vermilion County\n",
      "St. Louis County\n",
      "Boone County\n",
      "Tehama County\n",
      "Dane County\n",
      "Fisher County\n",
      "Sabine Parish\n",
      "Morgan County\n",
      "Pulaski County\n",
      "Bertie County\n",
      "Stanly County\n",
      "Rhea County\n",
      "Greene County\n",
      "Leslie County\n",
      "Somerset County\n",
      "Marshall County\n",
      "Lyon County\n",
      "Concho County\n",
      "Coke County\n",
      "Overton County\n",
      "Huron County\n",
      "Iosco County\n",
      "Coffee County\n",
      "Ware County\n",
      "Grant County\n",
      "Jefferson Parish\n",
      "St. Tammany Parish\n",
      "Hardin County\n",
      "Cameron Parish\n",
      "Clinton County\n",
      "St. Louis County\n",
      "Lorain County\n",
      "Vega Alta Municipio\n",
      "Boone County\n",
      "Polk County\n",
      "Dixon County\n",
      "Harford County\n",
      "Edgefield County\n",
      "Accomack County\n",
      "Calumet County\n",
      "Knox County\n",
      "Ionia County\n",
      "New Hanover County\n",
      "Obion County\n",
      "Calloway County\n",
      "Albemarle County\n",
      "Robertson County\n",
      "Clarke County\n",
      "Garfield County\n",
      "Jackson County\n",
      "Cook County\n",
      "Oconee County\n",
      "East Baton Rouge Parish\n",
      "Claiborne County\n",
      "St. Mary's County\n",
      "Kent County\n",
      "Pitt County\n",
      "Carbon County\n",
      "Stanton County\n",
      "Appling County\n",
      "Jasper County\n",
      "Wayne County\n",
      "Cottle County\n",
      "Greensville County\n",
      "Polk County\n",
      "Young County\n",
      "Tallapoosa County\n",
      "Rockingham County\n",
      "Rio Grande County\n",
      "Plymouth County\n",
      "Yates County\n",
      "King County\n",
      "Deschutes County\n",
      "Pottawattamie County\n",
      "Wright County\n",
      "Toole County\n",
      "Tioga County\n",
      "Lee County\n",
      "Fulton County\n",
      "Cherokee County\n",
      "Audrain County\n",
      "Colleton County\n",
      "Jefferson County\n",
      "Greene County\n",
      "Hall County\n",
      "Burnett County\n",
      "Torrance County\n",
      "Pacific County\n",
      "Pender County\n",
      "Hood County\n",
      "Stanley County\n",
      "Washoe County\n",
      "Ballard County\n",
      "Archer County\n",
      "Baylor County\n",
      "San Augustine County\n",
      "Storey County\n",
      "Schley County\n",
      "Fairfield County\n",
      "Madison County\n",
      "San Joaquin County\n",
      "Winston County\n",
      "Henry County\n",
      "Mercer County\n",
      "Wheeler County\n",
      "Lewis County\n",
      "Grant County\n",
      "Humphreys County\n",
      "Clarke County\n",
      "Chase County\n",
      "Trigg County\n",
      "Houston County\n",
      "Aurora County\n",
      "Aleutians East Borough\n",
      "Franklin County\n",
      "Kent County\n",
      "Crawford County\n",
      "Chippewa County\n",
      "Pennington County\n",
      "Hampton County\n",
      "Fremont County\n",
      "Bryan County\n",
      "Dinwiddie County\n",
      "St. Lucie County\n",
      "Monroe County\n",
      "Lincoln County\n",
      "Chippewa County\n",
      "Woodson County\n",
      "Marshall County\n",
      "Clinch County\n",
      "Lowndes County\n",
      "Kalawao County\n",
      "Kauai County\n",
      "Macomb County\n",
      "Turner County\n",
      "Jasper County\n",
      "Milam County\n",
      "Spencer County\n",
      "Hart County\n",
      "Lincoln County\n",
      "Blaine County\n",
      "Norfolk city\n",
      "Reeves County\n",
      "Pulaski County\n",
      "Union County\n",
      "McKenzie County\n",
      "Okaloosa County\n",
      "Alameda County\n",
      "Calhoun County\n",
      "Kosciusko County\n",
      "Noxubee County\n",
      "Woodruff County\n",
      "Gloucester County\n",
      "Hillsborough County\n",
      "Judith Basin County\n",
      "Mitchell County\n",
      "Powell County\n",
      "Polk County\n",
      "Wasco County\n",
      "Perkins County\n",
      "Taylor County\n",
      "Washington County\n",
      "Defiance County\n",
      "Greenbrier County\n",
      "Marion County\n",
      "Dickenson County\n",
      "Amelia County\n",
      "Randolph County\n",
      "Luna County\n",
      "Nueces County\n",
      "Weston County\n",
      "Toa Baja Municipio\n",
      "Warren County\n",
      "Madison County\n",
      "Wilson County\n",
      "Camp County\n",
      "Jefferson County\n",
      "Ritchie County\n",
      "Page County\n",
      "Jefferson County\n",
      "Iberia Parish\n",
      "Kusilvak Census Area\n",
      "Onslow County\n",
      "Faribault County\n",
      "Grainger County\n",
      "Freestone County\n",
      "Mifflin County\n",
      "Crenshaw County\n",
      "Bristol city\n",
      "Runnels County\n",
      "Terrell County\n",
      "Rawlins County\n",
      "Thomas County\n",
      "Jeff Davis County\n",
      "Cherokee County\n",
      "White County\n",
      "Leflore County\n",
      "Cooper County\n",
      "Dickinson County\n",
      "Will County\n",
      "Deaf Smith County\n",
      "Brookings County\n",
      "Clay County\n",
      "Coahoma County\n",
      "Boone County\n",
      "Des Moines County\n",
      "Scott County\n",
      "Ottawa County\n",
      "Columbia County\n",
      "Holmes County\n",
      "Harrison County\n",
      "Utuado Municipio\n",
      "Bradley County\n",
      "Carlton County\n",
      "Marion County\n",
      "Schoharie County\n",
      "Pawnee County\n",
      "Broome County\n",
      "Liberty County\n",
      "Athens County\n",
      "Jefferson County\n",
      "Randolph County\n",
      "Marion County\n",
      "Cumberland County\n",
      "Nevada County\n",
      "Douglas County\n",
      "Pulaski County\n",
      "Edgecombe County\n",
      "Jasper County\n",
      "Beaver County\n",
      "Murray County\n",
      "Jay County\n",
      "Montcalm County\n",
      "Rensselaer County\n",
      "Collier County\n",
      "McKinley County\n",
      "Ben Hill County\n",
      "Lee County\n",
      "Baker County\n",
      "Lanier County\n",
      "Rice County\n",
      "Calhoun County\n",
      "Jackson County\n",
      "Campbell County\n",
      "Cumberland County\n",
      "Panola County\n",
      "Hansford County\n",
      "Chambers County\n",
      "Quitman County\n",
      "Hardin County\n",
      "Litchfield County\n",
      "Sandusky County\n",
      "Piscataquis County\n",
      "Pulaski County\n",
      "Okfuskee County\n",
      "Saginaw County\n",
      "Rio Arriba County\n",
      "Caledonia County\n",
      "Botetourt County\n",
      "Madison County\n",
      "Collin County\n",
      "Abbeville County\n",
      "Dodge County\n",
      "Sarasota County\n",
      "Marquette County\n",
      "Mohave County\n",
      "Yavapai County\n",
      "Horry County\n",
      "Montgomery County\n",
      "Lewis County\n",
      "Arecibo Municipio\n",
      "Norton city\n",
      "Morris County\n",
      "Sullivan County\n",
      "Ness County\n",
      "Brazoria County\n",
      "Staunton city\n",
      "Chase County\n",
      "Montgomery County\n",
      "Throckmorton County\n",
      "Oglethorpe County\n",
      "Conway County\n",
      "Nodaway County\n",
      "Ransom County\n",
      "Bay County\n",
      "Shelby County\n",
      "Butte County\n",
      "Pine County\n",
      "Bastrop County\n",
      "Klickitat County\n",
      "San Juan County\n",
      "Brown County\n",
      "Wilson County\n",
      "Natchitoches Parish\n",
      "Terrebonne Parish\n",
      "Irwin County\n",
      "North Slope Borough\n",
      "Arenac County\n",
      "Lee County\n",
      "Osborne County\n",
      "Emmet County\n",
      "Fremont County\n",
      "Lincoln County\n",
      "Seneca County\n",
      "Laurel County\n",
      "Meigs County\n",
      "Taney County\n",
      "Taylor County\n",
      "Williamsburg city\n",
      "Scurry County\n",
      "Gilpin County\n",
      "McClain County\n",
      "Pendleton County\n",
      "Page County\n",
      "Le Flore County\n",
      "Summers County\n",
      "Mecklenburg County\n",
      "Essex County\n",
      "Linn County\n",
      "Montgomery County\n",
      "Sherman County\n",
      "Greene County\n",
      "Buffalo County\n",
      "Mellette County\n",
      "Ector County\n",
      "Limestone County\n",
      "Grays Harbor County\n",
      "Berkeley County\n",
      "Villalba Municipio\n",
      "Park County\n",
      "Denton County\n",
      "Cherokee County\n",
      "Yancey County\n",
      "Red River County\n",
      "Matagorda County\n",
      "Stevens County\n",
      "Warren County\n",
      "Hardeman County\n",
      "Monroe County\n",
      "Jenkins County\n",
      "Grayson County\n",
      "Palo Pinto County\n",
      "Heard County\n",
      "Lawrence County\n",
      "Guaynabo Municipio\n",
      "Marshall County\n",
      "Clark County\n",
      "Haskell County\n",
      "Bienville Parish\n",
      "Walker County\n",
      "Iowa County\n",
      "Buffalo County\n",
      "Beaver County\n",
      "Butler County\n",
      "Roosevelt County\n",
      "Barceloneta Municipio\n",
      "Cowlitz County\n",
      "Live Oak County\n",
      "Moniteau County\n",
      "Westmoreland County\n",
      "Yadkin County\n",
      "Merced County\n",
      "Dewey County\n",
      "Burke County\n",
      "Wayne County\n",
      "Warren County\n",
      "Howard County\n",
      "Davie County\n",
      "McDowell County\n",
      "Nevada County\n",
      "Yuma County\n",
      "Sherman County\n",
      "Uvalde County\n",
      "Auglaize County\n",
      "Bossier Parish\n",
      "Emmet County\n",
      "Saline County\n",
      "Magoffin County\n",
      "Bailey County\n",
      "Callaway County\n",
      "Albany County\n",
      "Park County\n",
      "Montour County\n",
      "Queens County\n",
      "Suwannee County\n",
      "Cheboygan County\n",
      "Gladwin County\n",
      "Montgomery County\n",
      "Lancaster County\n",
      "Larue County\n",
      "Woodbury County\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Taylor County\n",
      "Alexander County\n",
      "Jefferson County\n",
      "Lincoln County\n",
      "Chatham County\n",
      "Union County\n",
      "Genesee County\n",
      "Clay County\n",
      "Fallon County\n",
      "Potter County\n",
      "Culberson County\n",
      "Cumberland County\n",
      "Atascosa County\n",
      "Kingman County\n",
      "Rabun County\n",
      "Upshur County\n",
      "Texas County\n",
      "Pulaski County\n",
      "Crawford County\n",
      "Bannock County\n",
      "Geauga County\n",
      "Cayey Municipio\n",
      "Tulare County\n",
      "Arroyo Municipio\n",
      "San Germán Municipio\n",
      "Wayne County\n",
      "Rockbridge County\n",
      "Towner County\n",
      "Delaware County\n",
      "Niagara County\n",
      "Bennington County\n",
      "Clay County\n",
      "Wake County\n",
      "Hamilton County\n",
      "Bergen County\n",
      "Lincoln County\n",
      "Nome Census Area\n",
      "McCone County\n",
      "Buchanan County\n",
      "DuPage County\n",
      "Fall River County\n",
      "Kittson County\n",
      "Oconee County\n",
      "Wilson County\n",
      "Fillmore County\n",
      "Madison County\n",
      "Carolina Municipio\n",
      "Sullivan County\n",
      "La Paz County\n",
      "Brooks County\n",
      "Aleutians West Census Area\n",
      "Kodiak Island Borough\n",
      "Stafford County\n",
      "Telfair County\n",
      "Monroe County\n",
      "White County\n",
      "Noble County\n",
      "Livingston County\n",
      "Miller County\n",
      "Lincoln County\n",
      "Shelby County\n",
      "York County\n",
      "Adams County\n",
      "Allendale County\n",
      "Davidson County\n",
      "Uintah County\n",
      "Utah County\n",
      "Clay County\n",
      "Kings County\n",
      "Morgan County\n",
      "Holmes County\n",
      "Osceola County\n",
      "Jennings County\n",
      "Twin Falls County\n",
      "Saline County\n",
      "Kalamazoo County\n",
      "Lee County\n",
      "Johnson County\n",
      "Daviess County\n",
      "Grand Traverse County\n",
      "Allen Parish\n",
      "Hughes County\n",
      "Hyde County\n",
      "Clarendon County\n",
      "Stillwater County\n",
      "Bledsoe County\n",
      "Todd County\n",
      "Weakley County\n",
      "Greene County\n",
      "Lehigh County\n",
      "Seward County\n",
      "Chemung County\n",
      "Wyoming County\n",
      "Stanislaus County\n",
      "Northampton County\n",
      "Morgan County\n",
      "Breckinridge County\n",
      "Grenada County\n",
      "Simpson County\n",
      "Grand Isle County\n",
      "Columbiana County\n",
      "Nelson County\n",
      "Osceola County\n",
      "Grant County\n",
      "Laurens County\n",
      "New York County\n",
      "Benton County\n",
      "Isabela Municipio\n",
      "Marion County\n",
      "Nottoway County\n",
      "Warren County\n",
      "Columbia County\n",
      "Martinsville city\n",
      "Choctaw County\n",
      "Dickinson County\n",
      "Starr County\n",
      "Effingham County\n",
      "Roger Mills County\n",
      "Richland County\n",
      "Lea County\n",
      "Lamar County\n",
      "Florida Municipio\n",
      "Marshall County\n",
      "Appomattox County\n",
      "Madison County\n",
      "Sheridan County\n",
      "Cumberland County\n",
      "Franklin County\n",
      "Luzerne County\n",
      "Crawford County\n",
      "Russell County\n",
      "Carroll County\n",
      "Fluvanna County\n",
      "Lake County\n",
      "Madison County\n",
      "Dallas County\n",
      "Jackson County\n",
      "Kit Carson County\n",
      "Owyhee County\n",
      "Wood County\n",
      "Chautauqua County\n",
      "Cobb County\n",
      "Johnson County\n",
      "Belmont County\n",
      "Wise County\n",
      "Carter County\n",
      "Bryan County\n",
      "Clay County\n",
      "Charles County\n",
      "Cerro Gordo County\n",
      "Greene County\n",
      "Rowan County\n",
      "Wayne County\n",
      "Cape Girardeau County\n",
      "Walla Walla County\n",
      "Mississippi County\n",
      "Cleveland County\n",
      "Dallas County\n",
      "Lajas Municipio\n",
      "DeKalb County\n",
      "Ouachita Parish\n",
      "St. John the Baptist Parish\n",
      "St. Helena Parish\n",
      "Schuyler County\n",
      "Franklin County\n",
      "Carroll County\n",
      "Clear Creek County\n",
      "Kimble County\n",
      "Mackinac County\n",
      "McCulloch County\n",
      "Tishomingo County\n",
      "Crockett County\n",
      "Hill County\n",
      "Logan County\n",
      "Finney County\n",
      "Montgomery County\n",
      "Fairfield County\n",
      "Cheyenne County\n",
      "Martin County\n",
      "Sevier County\n",
      "Polk County\n",
      "Kent County\n",
      "Teton County\n",
      "Garden County\n",
      "Macoupin County\n",
      "Ross County\n",
      "Whiteside County\n",
      "El Paso County\n",
      "Loving County\n",
      "Latimer County\n",
      "Washington County\n",
      "Howell County\n",
      "Edwards County\n",
      "Jefferson County\n",
      "Logan County\n",
      "Winnebago County\n",
      "Fulton County\n",
      "Harvey County\n",
      "Dawson County\n",
      "Taylor County\n",
      "Midland County\n",
      "Quitman County\n",
      "Hardin County\n",
      "Jefferson County\n",
      "Hamlin County\n",
      "Lincoln County\n",
      "Franklin County\n",
      "Fredericksburg city\n",
      "Raleigh County\n",
      "Chaves County\n",
      "Santa Fe County\n",
      "Orange County\n",
      "Santa Cruz County\n",
      "Currituck County\n",
      "Lawrence County\n",
      "Howard County\n",
      "Pike County\n",
      "Christian County\n",
      "Eaton County\n",
      "Wapello County\n",
      "Imperial County\n",
      "Cass County\n",
      "Wilkinson County\n",
      "Yakutat City and Borough\n",
      "Sheridan County\n",
      "Leake County\n",
      "Caguas Municipio\n",
      "Camuy Municipio\n",
      "Clay County\n",
      "Franklin County\n",
      "Neshoba County\n",
      "Edmunds County\n",
      "Río Grande Municipio\n",
      "Conecuh County\n",
      "Dearborn County\n",
      "Jackson County\n",
      "Lee County\n",
      "West Feliciana Parish\n",
      "Crittenden County\n",
      "Jackson County\n",
      "Dickens County\n",
      "Mathews County\n",
      "Renville County\n",
      "La Salle County\n",
      "Onondaga County\n",
      "Henry County\n",
      "Harlan County\n",
      "Powder River County\n",
      "Juana Díaz Municipio\n",
      "Pepin County\n",
      "Apache County\n",
      "Macon County\n",
      "Lamb County\n",
      "Kiowa County\n",
      "Austin County\n",
      "Daviess County\n",
      "Seminole County\n",
      "Manistee County\n",
      "Lyon County\n",
      "Hutchinson County\n",
      "Texas County\n",
      "Woodward County\n",
      "Adams County\n",
      "Sutter County\n",
      "Potter County\n",
      "Val Verde County\n",
      "Harper County\n",
      "Monona County\n",
      "Juab County\n",
      "Stephens County\n",
      "Chenango County\n",
      "Peoria County\n",
      "Humboldt County\n",
      "Washington County\n",
      "Iowa County\n",
      "Morrison County\n",
      "Allegheny County\n",
      "Shelby County\n",
      "Madison County\n",
      "Washington County\n",
      "Champaign County\n",
      "Washington County\n",
      "Edgar County\n",
      "Washington County\n",
      "Hardin County\n",
      "Missaukee County\n",
      "Stutsman County\n",
      "Shannon County\n",
      "Smith County\n",
      "Tulsa County\n",
      "McIntosh County\n",
      "Robertson County\n",
      "Gillespie County\n",
      "Oakland County\n",
      "Golden Valley County\n",
      "Niobrara County\n",
      "Pipestone County\n",
      "King George County\n",
      "Grant County\n",
      "Renville County\n",
      "Alachua County\n",
      "Hooker County\n",
      "Prince Edward County\n",
      "Carbon County\n",
      "Bucks County\n",
      "Hand County\n",
      "Lycoming County\n",
      "Latah County\n",
      "Putnam County\n",
      "Galax city\n",
      "Quay County\n",
      "King County\n",
      "Lafayette County\n",
      "Tom Green County\n",
      "Hardee County\n",
      "Clermont County\n",
      "Yoakum County\n",
      "Yamhill County\n",
      "Louisa County\n",
      "Elk County\n",
      "Noble County\n",
      "Putnam County\n",
      "Somervell County\n",
      "Lebanon County\n",
      "Glacier County\n",
      "Pershing County\n",
      "Mahnomen County\n",
      "Passaic County\n",
      "Lake County\n",
      "Kenedy County\n",
      "Borden County\n",
      "Perry County\n",
      "San Saba County\n",
      "Kingfisher County\n",
      "Burleson County\n",
      "Fulton County\n",
      "Sunflower County\n",
      "Hennepin County\n",
      "Centre County\n",
      "Bee County\n",
      "Henderson County\n",
      "Tama County\n",
      "Seward County\n",
      "Monroe County\n",
      "Richardson County\n",
      "Christian County\n",
      "Nassau County\n",
      "Washington County\n",
      "Baker County\n",
      "Thomas County\n",
      "Anderson County\n",
      "Oldham County\n",
      "Cherokee County\n",
      "Oliver County\n",
      "Osceola County\n",
      "McNairy County\n",
      "Adams County\n",
      "Dade County\n",
      "St. Mary Parish\n",
      "Chittenden County\n",
      "Comerío Municipio\n",
      "Maui County\n",
      "Lafourche Parish\n",
      "Muscatine County\n",
      "Santa Rosa County\n",
      "Martin County\n",
      "Rockcastle County\n",
      "Trimble County\n",
      "Chattooga County\n",
      "Dillon County\n",
      "Jones County\n",
      "Scotland County\n",
      "Nemaha County\n",
      "Norton County\n",
      "Aguas Buenas Municipio\n",
      "Cataño Municipio\n",
      "Furnas County\n",
      "Decatur County\n",
      "Wayne County\n",
      "Barren County\n",
      "Howard County\n",
      "Dunn County\n",
      "Amador County\n",
      "Fentress County\n",
      "Coffey County\n",
      "Branch County\n",
      "Campbell County\n",
      "Meigs County\n",
      "Nicholas County\n",
      "Grant County\n",
      "Spink County\n",
      "Windsor County\n",
      "Trinity County\n",
      "Bernalillo County\n",
      "Mitchell County\n",
      "Hawaii County\n",
      "McCreary County\n",
      "Pendleton County\n",
      "Spencer County\n",
      "Hill County\n",
      "Valley County\n",
      "Castro County\n",
      "Washington County\n",
      "Letcher County\n",
      "Salem County\n",
      "Lynchburg city\n",
      "Saline County\n",
      "Mason County\n",
      "Gilmer County\n",
      "Jefferson County\n",
      "Rolette County\n",
      "Treasure County\n",
      "Clark County\n",
      "Morovis Municipio\n",
      "Allegan County\n",
      "Benton County\n",
      "Brown County\n",
      "Pickett County\n",
      "Louisa County\n",
      "Shelby County\n",
      "Franklin County\n",
      "Iron County\n",
      "Esmeralda County\n",
      "Keweenaw County\n",
      "Sanpete County\n",
      "Kearny County\n",
      "Brevard County\n",
      "Monroe County\n",
      "Lucas County\n",
      "Woodford County\n",
      "Jasper County\n",
      "Brewster County\n",
      "McCormick County\n",
      "Union County\n",
      "Nicollet County\n",
      "Marinette County\n",
      "Clark County\n",
      "Price County\n",
      "Miami County\n",
      "Ellsworth County\n",
      "West Carroll Parish\n",
      "Liberty County\n",
      "Hodgeman County\n",
      "Meade County\n",
      "McLean County\n",
      "Adams County\n",
      "Las Marías Municipio\n",
      "Itawamba County\n",
      "Franklin County\n",
      "Hancock County\n",
      "Knox County\n",
      "Newton County\n",
      "Faulk County\n",
      "Houghton County\n",
      "Mineral County\n",
      "Franklin County\n",
      "Concordia Parish\n",
      "Livingston Parish\n",
      "Essex County\n",
      "Butte County\n",
      "Douglas County\n",
      "Richland County\n",
      "Madison County\n",
      "Murray County\n",
      "Brooke County\n",
      "Calhoun County\n",
      "Bland County\n",
      "Yellowstone County\n",
      "Lincoln County\n",
      "Lake County\n",
      "Grady County\n",
      "Conejos County\n",
      "San Juan County\n",
      "Putnam County\n",
      "Gooding County\n",
      "Tipton County\n",
      "West Baton Rouge Parish\n",
      "Putnam County\n",
      "Teton County\n",
      "Grant County\n",
      "Morton County\n",
      "Chowan County\n",
      "Buncombe County\n",
      "Plumas County\n",
      "Petersburg city\n",
      "Washington County\n",
      "Meade County\n",
      "Marion County\n",
      "Chicot County\n",
      "Bibb County\n",
      "Guayanilla Municipio\n",
      "San Sebastián Municipio\n",
      "Pope County\n",
      "Southampton County\n",
      "Gregg County\n",
      "Rockland County\n",
      "Marion County\n",
      "Suffolk city\n",
      "El Paso County\n",
      "St. Francois County\n",
      "Ward County\n",
      "Kiowa County\n",
      "Wilbarger County\n",
      "Curry County\n",
      "Teller County\n",
      "Clinton County\n",
      "Wasatch County\n",
      "Caribou County\n",
      "Rockingham County\n",
      "Prairie County\n",
      "Bradley County\n",
      "Hamilton County\n",
      "Caroline County\n",
      "Douglas County\n",
      "Jefferson County\n",
      "Fairfax County\n",
      "Deer Lodge County\n",
      "Anderson County\n",
      "Huron County\n",
      "Bacon County\n",
      "Kent County\n",
      "Wood County\n",
      "Jackson County\n",
      "Anderson County\n",
      "Knox County\n",
      "Wheatland County\n",
      "Cannon County\n",
      "Franklin County\n",
      "Menifee County\n",
      "McPherson County\n",
      "Gunnison County\n",
      "Charlevoix County\n",
      "Swift County\n",
      "Seneca County\n",
      "Tattnall County\n",
      "Stephens County\n",
      "Martin County\n",
      "Ravalli County\n",
      "Wilkes County\n",
      "Lincoln County\n",
      "San Mateo County\n",
      "Williams County\n",
      "Baca County\n",
      "Boundary County\n",
      "Bear Lake County\n",
      "Union County\n",
      "Cuyahoga County\n",
      "Lavaca County\n",
      "Nowata County\n",
      "Glascock County\n",
      "Umatilla County\n",
      "Oglala Lakota County\n",
      "Marshall County\n",
      "Madison Parish\n",
      "Valley County\n",
      "Whitfield County\n",
      "Wichita County\n",
      "Charles Mix County\n",
      "Cedar County\n",
      "Kitsap County\n",
      "McHenry County\n",
      "Petroleum County\n",
      "Carroll County\n",
      "Whitman County\n",
      "Steele County\n",
      "Thayer County\n",
      "Crockett County\n",
      "Hamilton County\n",
      "Warren County\n",
      "Spalding County\n",
      "Hunterdon County\n",
      "Vernon County\n",
      "Parke County\n",
      "Franklin County\n",
      "Butts County\n",
      "Elbert County\n",
      "Bristol County\n",
      "Bosque County\n",
      "Newport County\n",
      "Fairfield County\n",
      "Pierce County\n",
      "Carroll County\n",
      "Red Lake County\n",
      "Jefferson County\n",
      "Cheatham County\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Union County\n",
      "Elmore County\n",
      "Lumpkin County\n",
      "Knox County\n",
      "Bremer County\n",
      "Goliad County\n",
      "Henderson County\n",
      "Indian River County\n",
      "Roberts County\n",
      "Deuel County\n",
      "Livingston County\n",
      "O'Brien County\n",
      "Callahan County\n",
      "Rains County\n",
      "Grant County\n",
      "Lee County\n",
      "Sierra County\n",
      "Drew County\n",
      "Morrill County\n",
      "Benton County\n",
      "Pike County\n",
      "Mesa County\n",
      "Dent County\n",
      "Tazewell County\n",
      "Pike County\n",
      "Susquehanna County\n",
      "Morris County\n",
      "Washington County\n",
      "Addison County\n",
      "Leavenworth County\n",
      "Muskegon County\n",
      "Hinds County\n",
      "Lampasas County\n",
      "Loudoun County\n",
      "St. Clair County\n",
      "Delaware County\n",
      "Phillips County\n",
      "Mercer County\n",
      "Mason County\n",
      "Nash County\n",
      "York County\n",
      "Pettis County\n",
      "Missoula County\n",
      "Chautauqua County\n",
      "Upshur County\n",
      "Culpeper County\n",
      "Haskell County\n",
      "Ohio County\n",
      "Morgan County\n",
      "Rockingham County\n",
      "Whitley County\n",
      "Siskiyou County\n",
      "Day County\n",
      "Orleans Parish\n",
      "Jefferson County\n",
      "Walker County\n",
      "DeKalb County\n",
      "Gadsden County\n",
      "Dade County\n",
      "DeSoto County\n",
      "Warren County\n",
      "Edwards County\n",
      "Madison County\n",
      "Saipan Municipality\n",
      "Randolph County\n",
      "Ashe County\n",
      "Dolores County\n",
      "Licking County\n",
      "Manassas city\n",
      "Union County\n",
      "Henderson County\n",
      "Montgomery County\n",
      "Arapahoe County\n",
      "Marion County\n",
      "Skagit County\n",
      "Jones County\n",
      "Columbia County\n",
      "Brunswick County\n",
      "Clearwater County\n",
      "Northampton County\n",
      "Rooks County\n",
      "Fayette County\n",
      "Hall County\n",
      "Hamilton County\n",
      "Loup County\n",
      "Sheridan County\n",
      "Frontier County\n",
      "Luquillo Municipio\n",
      "Bibb County\n",
      "Lauderdale County\n",
      "Big Stone County\n",
      "Blue Earth County\n",
      "Highland County\n",
      "Spotsylvania County\n",
      "Strafford County\n",
      "Houston County\n",
      "Delta County\n",
      "Sebastian County\n",
      "Santa Cruz County\n",
      "McIntosh County\n",
      "Monroe County\n",
      "Dunklin County\n",
      "Wheeler County\n",
      "Forsyth County\n",
      "San Patricio County\n",
      "Walthall County\n",
      "Monroe County\n",
      "Isabella County\n",
      "Moore County\n",
      "Calhoun County\n",
      "Sublette County\n",
      "Fleming County\n",
      "Clark County\n",
      "York County\n",
      "Adams County\n",
      "Ascension Parish\n",
      "Union County\n",
      "Chesterfield County\n",
      "Acadia Parish\n",
      "Crawford County\n",
      "Tripp County\n",
      "Guthrie County\n",
      "Washington County\n",
      "Sanborn County\n",
      "Grady County\n",
      "Kanawha County\n",
      "St. Croix County\n",
      "Venango County\n",
      "Summit County\n",
      "Glynn County\n",
      "Webb County\n",
      "Montgomery County\n",
      "Aroostook County\n",
      "Jefferson Davis County\n",
      "Washington County\n",
      "Blanco County\n",
      "Brunswick County\n",
      "Dyer County\n",
      "Gibson County\n",
      "Prince George County\n",
      "Lawrence County\n",
      "Eddy County\n",
      "Pierce County\n",
      "Lincoln County\n",
      "Lancaster County\n",
      "Juneau County\n",
      "Scott County\n",
      "Corson County\n",
      "Gregory County\n",
      "Vance County\n",
      "Caldwell County\n",
      "Barnwell County\n",
      "Decatur County\n",
      "Blackford County\n",
      "Etowah County\n",
      "Camas County\n",
      "Reno County\n",
      "Maury County\n",
      "Goshen County\n",
      "Rusk County\n",
      "Waukesha County\n",
      "Garrard County\n",
      "Norfolk County\n",
      "Hendricks County\n",
      "Jackson County\n",
      "Georgetown County\n",
      "Hettinger County\n",
      "Grand County\n",
      "Tooele County\n",
      "Hampton city\n",
      "Buffalo County\n",
      "Frederick County\n",
      "Lewis County\n",
      "Polk County\n",
      "Redwood County\n",
      "Fayette County\n",
      "Swains Island\n",
      "St. Charles Parish\n",
      "Poinsett County\n",
      "Gulf County\n",
      "Hamblen County\n",
      "Chilton County\n",
      "Newton County\n",
      "Hockley County\n",
      "Baldwin County\n",
      "Transylvania County\n",
      "Surry County\n",
      "Coffee County\n",
      "Shelby County\n",
      "Canyon County\n",
      "Daniels County\n",
      "Leon County\n",
      "Payne County\n",
      "Covington County\n",
      "Lawrence County\n",
      "Gray County\n",
      "Casey County\n",
      "Metcalfe County\n",
      "Russell County\n",
      "Beauregard Parish\n",
      "Somerset County\n",
      "Cimarron County\n",
      "Meade County\n",
      "Nelson County\n",
      "Owen County\n",
      "Pemiscot County\n",
      "Nance County\n",
      "Menominee County\n",
      "Panola County\n",
      "Bath County\n",
      "Anderson County\n",
      "Caroline County\n",
      "Sioux County\n",
      "Glenn County\n",
      "St. Louis city\n",
      "Fannin County\n",
      "Grant County\n",
      "Marshall County\n",
      "Thurston County\n",
      "Knox County\n",
      "Valencia County\n",
      "Prairie County\n",
      "Allamakee County\n",
      "Cameron County\n",
      "Montgomery County\n",
      "Las Animas County\n",
      "Llano County\n",
      "Mason County\n",
      "Clay County\n",
      "Orange County\n",
      "Schenectady County\n",
      "Mingo County\n",
      "Wabaunsee County\n",
      "Houston County\n",
      "Nicholas County\n",
      "Plymouth County\n",
      "Bronx County\n",
      "Dare County\n",
      "Medina County\n",
      "Armstrong County\n",
      "Atlantic County\n",
      "Manitowoc County\n",
      "Door County\n",
      "Columbus County\n",
      "Gallia County\n",
      "Taylor County\n",
      "Colonial Heights city\n",
      "Coshocton County\n",
      "Perkins County\n",
      "Hartley County\n",
      "Grand County\n",
      "Jim Wells County\n",
      "Winnebago County\n",
      "San Luis Obispo County\n",
      "Henry County\n",
      "Wyandot County\n",
      "Zapata County\n",
      "Lee County\n",
      "Boyd County\n",
      "Carver County\n",
      "Colfax County\n",
      "Chesterfield County\n",
      "Lewis County\n",
      "Washington County\n",
      "Virginia Beach city\n",
      "Madison County\n",
      "Lancaster County\n",
      "Bates County\n",
      "Belknap County\n",
      "Richmond County\n",
      "Skagway Municipality\n",
      "Hoonah-Angoon Census Area\n",
      "Franklin County\n",
      "Ida County\n",
      "Sedgwick County\n",
      "Travis County\n",
      "Hillsborough County\n",
      "Mercer County\n",
      "Butler County\n",
      "Westmoreland County\n",
      "Charlotte County\n",
      "Cass County\n",
      "Mercer County\n",
      "Rose Island\n",
      "Johnson County\n",
      "Kent County\n",
      "Windham County\n",
      "Orleans County\n",
      "Jackson County\n",
      "Franklin Parish\n",
      "Webster County\n",
      "Franklin County\n",
      "Cherry County\n",
      "Beaverhead County\n",
      "New Madrid County\n",
      "Hempstead County\n",
      "Camden County\n",
      "Mecklenburg County\n",
      "Webster County\n",
      "Garfield County\n",
      "Skamania County\n",
      "Lenawee County\n",
      "Gilmer County\n",
      "Roseau County\n",
      "Madison County\n",
      "Howard County\n",
      "Wayne County\n"
     ]
    }
   ],
   "source": [
    "with fiona.open(\"/home/aishw/shared_folder/user-location-processing/data/us_county/tl_2019_us_county.shp\") as shape:\n",
    "    print(shape.schema)\n",
    "    \n",
    "    for row in shape:\n",
    "        print(row['properties']['NAMELSAD'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_dataframe(table_name,device_key):\n",
    "    return spark.sql(f\"select longitude,latitude, unix_time as timestamps from {table_name} where device_key={device_key}\").toPandas()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>coordinates</th>\n",
       "      <th>timestamps</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[[-87.78321, 41.84039], [-87.7289, 41.84973]]</td>\n",
       "      <td>[-196213, -11469]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     coordinates         timestamps\n",
       "0  [[-87.78321, 41.84039], [-87.7289, 41.84973]]  [-196213, -11469]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pdf = get_dataframe('location_df','2048')\n",
    "#pdf[['longitude','latitude']].values.tolist()\n",
    "pdf['coordinates'] = pdf[['longitude','latitude']].values.tolist()\n",
    "pdf['timestamps'] = pdf['timestamps'] - 1546549696\n",
    "ndf = pd.DataFrame([[pdf['coordinates'].values.tolist(),pdf['timestamps'].values.tolist()]],columns=['coordinates','timestamps'])\n",
    "ndf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#TRIPS_LAYER_DATA = \"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/sf.trips.json\"  # noqa\n",
    "#\n",
    "#df = pd.read_json(TRIPS_LAYER_DATA)\n",
    "#df[\"coordinates\"] = df[\"waypoints\"].apply(lambda f: [item[\"coordinates\"] for item in f])\n",
    "#df[\"timestamps\"] = df[\"waypoints\"].apply(lambda f: [item[\"timestamp\"] - 1554772579000 for item in f])\n",
    "#\n",
    "#df.drop([\"waypoints\"], axis=1, inplace=True)\n",
    "#df.coordinates\n",
    "#\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "map_style = 'https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json'\n",
    "\n",
    "layer = pdk.Layer(\n",
    "    \"TripsLayer\",\n",
    "    ndf,\n",
    "    get_path='coordinates',\n",
    "    get_timestamps=\"timestamps\",\n",
    "    get_color=[253, 128, 93],\n",
    "    opacity=0.8,\n",
    "    width_min_pixels=5,\n",
    "    rounded=True,\n",
    "    trail_length=600,\n",
    "    current_time=500,\n",
    ")\n",
    "\n",
    "# Set the viewport location\n",
    "#view_state = pdk.ViewState(\n",
    "#    longitude=-88.083300,\n",
    "#    latitude=42.199820,\n",
    "#    zoom=6,\n",
    "#    min_zoom=5,\n",
    "#    max_zoom=15,\n",
    "#    pitch=40.5,\n",
    "#    bearing=-27.36)\n",
    "\n",
    "view_state = pdk.ViewState(latitude=42.24795, longitude=-88.00036, zoom=11, bearing=0, pitch=45)\n",
    "# Render\n",
    "r = pdk.Deck(layers=[layer], mapbox_key = mapbox_api_key,map_style=map_style, initial_view_state=view_state)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe src=\"about:blank\" frameborder=\"0\" srcdoc=\"&lt;html&gt;\n",
       "  &lt;head&gt;\n",
       "    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n",
       "    &lt;title&gt;pydeck&lt;/title&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css&quot; /&gt;\n",
       "    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css&quot; /&gt;\n",
       "    &lt;script src=&#x27;https://cdn.jsdelivr.net/npm/@deck.gl/jupyter-widget@~8.3.*/dist/index.js&#x27;&gt;&lt;/script&gt;\n",
       "    &lt;style&gt;\n",
       "    body {\n",
       "      margin: 0;\n",
       "      padding: 0;\n",
       "      overflow: hidden;\n",
       "    }\n",
       "\n",
       "    #deck-map-container {\n",
       "      width: 100%;\n",
       "      height: 100%;\n",
       "      background-color: black;\n",
       "    }\n",
       "\n",
       "    #map {\n",
       "      pointer-events: none;\n",
       "      height: 100%;\n",
       "      width: 100%;\n",
       "      position: absolute;\n",
       "      z-index: 1;\n",
       "    }\n",
       "\n",
       "    #deckgl-overlay {\n",
       "      z-index: 2;\n",
       "      background: none;\n",
       "    }\n",
       "\n",
       "    #deck-map-wrapper {\n",
       "      width: 100%;\n",
       "      height: 100%;\n",
       "    }\n",
       "\n",
       "    #deck-container {\n",
       "      width: 100vw;\n",
       "      height: 100vh;\n",
       "    }\n",
       "    &lt;/style&gt;\n",
       "  &lt;/head&gt;\n",
       "  &lt;body&gt;\n",
       "    &lt;div id=&quot;deck-container&quot;&gt;\n",
       "    &lt;/div&gt;\n",
       "  &lt;/body&gt;\n",
       "  &lt;script&gt;\n",
       "    const jsonInput = {&quot;initialViewState&quot;: {&quot;bearing&quot;: 0, &quot;latitude&quot;: 42.24795, &quot;longitude&quot;: -88.00036, &quot;pitch&quot;: 45, &quot;zoom&quot;: 11}, &quot;layers&quot;: [{&quot;@@type&quot;: &quot;TripsLayer&quot;, &quot;currentTime&quot;: 500, &quot;data&quot;: [{&quot;coordinates&quot;: [[-87.78321, 41.84039], [-87.7289, 41.84973]], &quot;timestamps&quot;: [-196213, -11469]}], &quot;getColor&quot;: [253, 128, 93], &quot;getPath&quot;: &quot;@@=coordinates&quot;, &quot;getTimestamps&quot;: &quot;@@=timestamps&quot;, &quot;id&quot;: &quot;51d75c98-9707-44a6-8b07-4885e954afd5&quot;, &quot;opacity&quot;: 0.8, &quot;rounded&quot;: true, &quot;trailLength&quot;: 600, &quot;widthMinPixels&quot;: 5}], &quot;mapProvider&quot;: &quot;mapbox&quot;, &quot;mapStyle&quot;: &quot;https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json&quot;, &quot;views&quot;: [{&quot;@@type&quot;: &quot;MapView&quot;, &quot;controller&quot;: true}]};\n",
       "    const MAPBOX_API_KEY = &#x27;pk.eyJ1IjoiYWlzaHdhcnlhZGFiaGFkZSIsImEiOiJja2ZscGc4OG0wd2xpMndtcWRrOGd4d2RiIn0.3r_VOvQWdMWLQ5qKXP6WYg&#x27;;\n",
       "    const GOOGLE_MAPS_API_KEY = &#x27;None&#x27;;\n",
       "    const tooltip = true;\n",
       "    const customLibraries = null;\n",
       "\n",
       "    const deck = createDeck({\n",
       "      mapboxApiKey: MAPBOX_API_KEY,\n",
       "      googleMapsKey: GOOGLE_MAPS_API_KEY,\n",
       "      container: document.getElementById(&#x27;deck-container&#x27;),\n",
       "      jsonInput,\n",
       "      tooltip,\n",
       "      customLibraries\n",
       "    });\n",
       "\n",
       "  &lt;/script&gt;\n",
       "&lt;/html&gt;\" width=\"100%\" height=500></iframe>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "r.to_html()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
